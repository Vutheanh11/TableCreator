// Tab Switching Function
function switchTab(event, lessonId) {
    // Hide all tab contents
    const tabContents = document.getElementsByClassName('tab-content');
    for (let i = 0; i < tabContents.length; i++) {
        tabContents[i].classList.remove('active');
    }
    
    // Remove active class from all buttons
    const tabButtons = document.getElementsByClassName('tab-button');
    for (let i = 0; i < tabButtons.length; i++) {
        tabButtons[i].classList.remove('active');
    }
    
    // Show selected tab content
    document.getElementById(lessonId).classList.add('active');
    
    // Add active class to clicked button
    event.currentTarget.classList.add('active');
}

// Background Music Control
function toggleMusic() {
    const music = document.getElementById('bgMusic');
    const toggle = document.getElementById('bgMusicToggle');
    const status = document.getElementById('musicStatus');
    
    if (toggle.checked) {
        music.play().catch(e => console.log('Music play failed:', e));
        status.textContent = 'Báº­t';
        localStorage.setItem('musicEnabled', 'true');
    } else {
        music.pause();
        status.textContent = 'Táº¯t';
        localStorage.setItem('musicEnabled', 'false');
    }
}

// Dark Mode Control
function toggleDarkMode() {
    const toggle = document.getElementById('darkModeToggle');
    const status = document.getElementById('darkModeStatus');
    
    if (toggle.checked) {
        document.body.classList.add('dark-mode');
        status.textContent = 'Báº­t';
        localStorage.setItem('darkMode', 'true');
    } else {
        document.body.classList.remove('dark-mode');
        status.textContent = 'Táº¯t';
        localStorage.setItem('darkMode', 'false');
    }
}

// AI Reading Generator with Gemini API
const GEMINI_API_KEY = 'AIzaSyBgnR2T8yRS0Gf4bfiCegVliUn9b-Tk5q0';

// All available kanji from lessons 8-11
const ALL_KANJI = ['å®¶', 'æ—', 'çˆ¶', 'æ¯', 'å…„', 'å¼Ÿ', 'å§‰', 'å¦¹', 'çŠ¬', 'é«˜', 'çŸ­', 'é•·', 'å¥½', 'æ­Œ', 'éŸ³', 'æ¥½', 'è»Š', 'æ˜ ', 'ç”»', 'æ—…', 'æµ·', 'å¤–', 'é§…', 'ä¸Š', 'ä¸‹', 'åœ°', 'å›³', 'é¤¨', 'å³', 'å·¦', 'é“', 'èµ·', 'æ­©', 'ä¹—', 'å§‹', 'çµ‚', 'å‹‰', 'å¼·', 'æœ', 'æ˜¼', 'å¤œ'];

// Random topics for variety
const TOPICS = [
    'å®¶æ—ã«ã¤ã„ã¦',
    'é€±æœ«ã®éã”ã—æ–¹',
    'è¶£å‘³ã«ã¤ã„ã¦', 
    'æ¯æ—¥ã®ç”Ÿæ´»',
    'æ—…è¡Œã®æ€ã„å‡º',
    'å¥½ããªã“ã¨',
    'å­¦æ ¡ç”Ÿæ´»',
    'å‹é”ã¨éŠã¶'
];

function getRandomKanji() {
    // Shuffle and pick 5-7 random kanji
    const shuffled = [...ALL_KANJI].sort(() => 0.5 - Math.random());
    const count = Math.floor(Math.random() * 3) + 5; // 5-7
    return shuffled.slice(0, count);
}

function getRandomTopic() {
    return TOPICS[Math.floor(Math.random() * TOPICS.length)];
}

async function generateReading() {
    const btn = document.getElementById('generateBtn');
    const btnText = document.getElementById('btnText');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const readingResult = document.getElementById('readingResult');
    const readingContent = document.getElementById('readingContent');

    // Disable button and show loading
    btn.disabled = true;
    btnText.textContent = 'â³ Äang táº¡o...';
    loadingSpinner.style.display = 'block';
    readingResult.style.display = 'none';

    // Get random kanji and topic
    const selectedKanji = getRandomKanji();
    const topic = getRandomTopic();
    
    const prompt = `HÃ£y táº¡o má»™t bÃ i Ä‘á»c tiáº¿ng Nháº­t vá» chá»§ Ä‘á»: ${topic}

YÃŠU Cáº¦U QUAN TRá»ŒNG:
1. Viáº¿t thÃ nh 1 ÄOáº N VÄ‚N liÃªn tá»¥c 12-15 cÃ¢u (khÃ´ng xuá»‘ng dÃ²ng giá»¯a cÃ¡c cÃ¢u)
2. CHá»ˆ sá»­ dá»¥ng 5-7 CHá»® KANJI tá»« list sau (khÃ´ng Ä‘Æ°á»£c dÃ¹ng chá»¯ nÃ o khÃ¡c): ${selectedKanji.join(', ')}
3. Táº¥t cáº£ Kanji PHáº¢I cÃ³ furigana format: å®¶[ã„ãˆ]
4. TUYá»†T Äá»I KHÃ”NG dÃ¹ng Kanji khÃ¡c ngoÃ i list trÃªn
5. Sá»­ dá»¥ng láº¡i cÃ¡c Kanji nhiá»u láº§n trong bÃ i Ä‘á»ƒ lÃ m dÃ i bÃ i Ä‘á»c
6. Format:

ç§[ã‚ãŸã—]ã®å®¶[ã„ãˆ]æ—[ãã]ã¯å››[ã‚ˆ]äºº[ã«ã‚“]ã§ã™ã€‚çˆ¶[ã¡ã¡]ã¨æ¯[ã¯ã¯]ã¨å…„[ã‚ã«]ãŒã„ã¾ã™ã€‚å…„[ã‚ã«]ã¯éŸ³[ãŠã‚“]æ¥½[ãŒã]ãŒå¥½[ã™]ãã§ã™ã€‚é€±[ã—ã‚…ã†]æœ«[ã¾ã¤]ã¯ã‚ˆãå®¶[ã‹]æ—[ãã]ã§æ˜ [ãˆã„]ç”»[ãŒ]ã‚’è¦‹[ã¿]ã¾ã™ã€‚å¤[ãªã¤]ã«æµ·[ã†ã¿]ã¸æ—…[ã‚Šã‚‡]è¡Œ[ã“ã†]ã—ã¾ã—ãŸã€‚

Sau Ä‘Ã³ xuá»‘ng 2 dÃ²ng vÃ  viáº¿t dá»‹ch tiáº¿ng Viá»‡t:

Gia Ä‘Ã¬nh tÃ´i cÃ³ bá»‘n ngÆ°á»i. CÃ³ bá»‘, máº¹ vÃ  anh trai. Anh trai thÃ­ch Ã¢m nháº¡c. Cuá»‘i tuáº§n thÆ°á»ng cÃ¹ng gia Ä‘Ã¬nh xem phim. MÃ¹a hÃ¨ Ä‘Ã£ Ä‘i du lá»‹ch biá»ƒn.

LÆ¯U Ã:
- KHÃ”NG xuá»‘ng dÃ²ng giá»¯a cÃ¡c cÃ¢u tiáº¿ng Nháº­t
- CHá»ˆ dÃ¹ng Kanji trong list trÃªn
- CÃ¢u vÄƒn Ä‘Æ¡n giáº£n, ngáº¯n gá»n`;

    try {
        // Use v1beta API endpoint with gemini-2.0-flash model
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent`;
        
        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-goog-api-key': GEMINI_API_KEY
            },
            body: JSON.stringify({
                contents: [{
                    parts: [{
                        text: prompt
                    }]
                }],
                generationConfig: {
                    temperature: 0.9,
                    maxOutputTokens: 1024
                }
            })
        });

        const data = await response.json();
        
        if (!response.ok) {
            throw new Error(data.error?.message || `API Error: ${response.status}`);
        }

        if (!data.candidates || !data.candidates[0] || !data.candidates[0].content) {
            throw new Error('Invalid response from API');
        }

        const generatedText = data.candidates[0].content.parts[0].text;

        // Format the reading content
        const formattedContent = formatReadingContent(generatedText);
        readingContent.innerHTML = formattedContent;

        // Show result
        loadingSpinner.style.display = 'none';
        readingResult.style.display = 'block';
        btnText.textContent = 'ğŸ¯ START - Táº¡o BÃ i Äá»c Má»›i';
        btn.disabled = false;

    } catch (error) {
        console.error('Error:', error);
        loadingSpinner.style.display = 'none';
        readingContent.innerHTML = `
            <div class="note" style="background: #ff6b6b; color: white; border: 6px solid #000;">
                <div class="note-title">âŒ Lá»—i:</div>
                <p>KhÃ´ng thá»ƒ táº¡o bÃ i Ä‘á»c. Vui lÃ²ng thá»­ láº¡i!</p>
                <p style="font-size: 0.8em; margin-top: 10px;">Chi tiáº¿t: ${error.message}</p>
                <p style="font-size: 0.7em; margin-top: 10px;">LÆ°u Ã½: Cáº§n káº¿t ná»‘i internet vÃ  API key há»£p lá»‡</p>
            </div>
        `;
        readingResult.style.display = 'block';
        btnText.textContent = 'ğŸ¯ START - Táº¡o BÃ i Äá»c';
        btn.disabled = false;
    }
}

let romajiVisible = false;

function toggleRomaji() {
    romajiVisible = !romajiVisible;
    const romajiBtnText = document.getElementById('romajiBtnText');
    const romajiElements = document.querySelectorAll('.romaji-text');
    const textWithRuby = document.querySelectorAll('.japanese-text-with-ruby');
    const textNoRuby = document.querySelectorAll('.japanese-text-no-ruby');
    
    if (romajiVisible) {
        romajiBtnText.textContent = 'ğŸ™ˆ áº¨n Furigana & Romaji';
        romajiElements.forEach(el => el.style.display = 'block');
        textWithRuby.forEach(el => el.style.display = 'block');
        textNoRuby.forEach(el => el.style.display = 'none');
    } else {
        romajiBtnText.textContent = 'ğŸ‘ï¸ Hiá»‡n Furigana & Romaji';
        romajiElements.forEach(el => el.style.display = 'none');
        textWithRuby.forEach(el => el.style.display = 'none');
        textNoRuby.forEach(el => el.style.display = 'block');
    }
}

function formatReadingContent(text) {
    // Split by double newline to separate Japanese paragraph from Vietnamese translation
    const parts = text.split('\n\n').filter(part => part.trim());
    let html = '';
    
    for (let part of parts) {
        const trimmedPart = part.trim();
        if (!trimmedPart) continue;

        // Check if it's Japanese text (contains hiragana/katakana/kanji)
        if (/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(trimmedPart)) {
            // Create two versions: with and without furigana
            let withFurigana = trimmedPart.replace(/([ä¸€-é¾¯ã€…]+)\[([ã-ã‚“ã‚¡-ãƒ³]+)\]/g, '<ruby>$1<rt>$2</rt></ruby>');
            let withoutFurigana = trimmedPart.replace(/([ä¸€-é¾¯ã€…]+)\[([ã-ã‚“ã‚¡-ãƒ³]+)\]/g, '$1');
            
            html += `<div class="example" style="margin-bottom: 25px;">
                <div class="japanese-text-no-ruby" style="font-size: 20px; line-height: 2.2; margin-bottom: 10px; text-align: justify;">${withoutFurigana}</div>
                <div class="japanese-text-with-ruby" style="display: none; font-size: 20px; line-height: 2.8; margin-bottom: 10px; text-align: justify;">${withFurigana}</div>
                <div class="romaji-text" style="display: none; color: #9966ff; font-size: 14px; margin-bottom: 10px; font-style: italic; line-height: 1.8; word-wrap: break-word; overflow-wrap: break-word;">${convertToRomaji(trimmedPart)}</div>`;
        } else if (trimmedPart.length > 0 && !trimmedPart.startsWith('#') && !trimmedPart.startsWith('**')) {
            // Vietnamese translation
            html += `<div class="meaning" style="color: #555; font-size: 15px; line-height: 1.8; text-align: justify; padding: 15px; background: rgba(153, 102, 255, 0.1); border-radius: 8px;">${trimmedPart}</div></div>`;
        }
    }

    return html || '<div class="note"><p>KhÃ´ng thá»ƒ format bÃ i Ä‘á»c. Vui lÃ²ng thá»­ láº¡i!</p></div>';
}

function convertToRomaji(text) {
    // Particles that should be separated
    const particles = ['ã¯', 'ãŒ', 'ã‚’', 'ã«', 'ã¸', 'ã¨', 'ã®', 'ã§', 'ã‚„', 'ã‚‚', 'ã‹', 'ã‹ã‚‰', 'ã¾ã§', 'ã‚ˆã‚Š'];
    
    // Hiragana to romaji map
    const hiraganaMap = {
        'ã‚': 'a', 'ã„': 'i', 'ã†': 'u', 'ãˆ': 'e', 'ãŠ': 'o',
        'ã‹': 'ka', 'ã': 'ki', 'ã': 'ku', 'ã‘': 'ke', 'ã“': 'ko',
        'ã•': 'sa', 'ã—': 'shi', 'ã™': 'su', 'ã›': 'se', 'ã': 'so',
        'ãŸ': 'ta', 'ã¡': 'chi', 'ã¤': 'tsu', 'ã¦': 'te', 'ã¨': 'to',
        'ãª': 'na', 'ã«': 'ni', 'ã¬': 'nu', 'ã­': 'ne', 'ã®': 'no',
        'ã¯': 'ha', 'ã²': 'hi', 'ãµ': 'fu', 'ã¸': 'he', 'ã»': 'ho',
        'ã¾': 'ma', 'ã¿': 'mi', 'ã‚€': 'mu', 'ã‚': 'me', 'ã‚‚': 'mo',
        'ã‚„': 'ya', 'ã‚†': 'yu', 'ã‚ˆ': 'yo',
        'ã‚‰': 'ra', 'ã‚Š': 'ri', 'ã‚‹': 'ru', 'ã‚Œ': 're', 'ã‚': 'ro',
        'ã‚': 'wa', 'ã‚’': 'wo', 'ã‚“': 'n',
        'ãŒ': 'ga', 'ã': 'gi', 'ã': 'gu', 'ã’': 'ge', 'ã”': 'go',
        'ã–': 'za', 'ã˜': 'ji', 'ãš': 'zu', 'ãœ': 'ze', 'ã': 'zo',
        'ã ': 'da', 'ã¢': 'ji', 'ã¥': 'zu', 'ã§': 'de', 'ã©': 'do',
        'ã°': 'ba', 'ã³': 'bi', 'ã¶': 'bu', 'ã¹': 'be', 'ã¼': 'bo',
        'ã±': 'pa', 'ã´': 'pi', 'ã·': 'pu', 'ãº': 'pe', 'ã½': 'po',
        'ãã‚ƒ': 'kya', 'ãã‚…': 'kyu', 'ãã‚‡': 'kyo',
        'ã—ã‚ƒ': 'sha', 'ã—ã‚…': 'shu', 'ã—ã‚‡': 'sho',
        'ã¡ã‚ƒ': 'cha', 'ã¡ã‚…': 'chu', 'ã¡ã‚‡': 'cho',
        'ã«ã‚ƒ': 'nya', 'ã«ã‚…': 'nyu', 'ã«ã‚‡': 'nyo',
        'ã²ã‚ƒ': 'hya', 'ã²ã‚…': 'hyu', 'ã²ã‚‡': 'hyo',
        'ã¿ã‚ƒ': 'mya', 'ã¿ã‚…': 'myu', 'ã¿ã‚‡': 'myo',
        'ã‚Šã‚ƒ': 'rya', 'ã‚Šã‚…': 'ryu', 'ã‚Šã‚‡': 'ryo',
        'ãã‚ƒ': 'gya', 'ãã‚…': 'gyu', 'ãã‚‡': 'gyo',
        'ã˜ã‚ƒ': 'ja', 'ã˜ã‚…': 'ju', 'ã˜ã‚‡': 'jo',
        'ã³ã‚ƒ': 'bya', 'ã³ã‚…': 'byu', 'ã³ã‚‡': 'byo',
        'ã´ã‚ƒ': 'pya', 'ã´ã‚…': 'pyu', 'ã´ã‚‡': 'pyo',
        'ã£': '',
        'ãƒ¼': '-'
    };
    
    // Extract furigana from brackets and add spaces around kanji
    let cleanText = text.replace(/([ä¸€-é¾¯ã€…]+)\[([ã-ã‚“ã‚¡-ãƒ³]+)\]/g, ' $2 ');
    
    // Add space after punctuation
    cleanText = cleanText.replace(/[ã€‚ã€]/g, ' ');
    
    let result = '';
    let i = 0;
    let currentWord = '';
    
    while (i < cleanText.length) {
        const char = cleanText[i];
        
        // Handle spaces
        if (char === ' ') {
            if (currentWord) {
                result += currentWord + ' ';
                currentWord = '';
            }
            i++;
            continue;
        }
        
        let found = false;
        
        // Try 2-character combinations first (for ã‚ƒ, ã‚…, ã‚‡)
        if (i < cleanText.length - 1) {
            const twoChar = cleanText.substring(i, i + 2);
            if (hiraganaMap[twoChar]) {
                currentWord += hiraganaMap[twoChar];
                i += 2;
                found = true;
            }
        }
        
        // Try single character
        if (!found) {
            if (hiraganaMap[char]) {
                const romaji = hiraganaMap[char];
                
                // Check if this is a particle
                if (particles.includes(char) && currentWord) {
                    // Add space before particle
                    result += currentWord + ' ';
                    currentWord = '';
                    
                    // Special case: ã¯ as particle = wa
                    if (char === 'ã¯') {
                        currentWord = 'wa';
                    } else if (char === 'ã¸') {
                        currentWord = 'e';
                    } else {
                        currentWord = romaji;
                    }
                } else {
                    currentWord += romaji;
                }
            } else {
                currentWord += char;
            }
            i++;
        }
    }
    
    // Add remaining word
    if (currentWord) {
        result += currentWord;
    }
    
    // Clean up multiple spaces
    return result.replace(/\s+/g, ' ').trim();
}

// Load saved settings on page load
window.addEventListener('DOMContentLoaded', function() {
    // Load music setting
    const musicEnabled = localStorage.getItem('musicEnabled') === 'true';
    const musicToggle = document.getElementById('bgMusicToggle');
    const musicStatus = document.getElementById('musicStatus');
    if (musicEnabled && musicToggle) {
        musicToggle.checked = true;
        musicStatus.textContent = 'Báº­t';
    }

    // Load dark mode setting
    const darkModeEnabled = localStorage.getItem('darkMode') === 'true';
    const darkModeToggle = document.getElementById('darkModeToggle');
    const darkModeStatus = document.getElementById('darkModeStatus');
    if (darkModeEnabled) {
        document.body.classList.add('dark-mode');
        if (darkModeToggle) {
            darkModeToggle.checked = true;
            darkModeStatus.textContent = 'Báº­t';
        }
    }
});

// Kanji Test System
const KANJI_DATA = {
    8: [
        {kanji: 'å®¶', meaning: 'nhÃ ', reading: 'ã„ãˆãƒ»ã†ã¡'},
        {kanji: 'æ—', meaning: 'tá»™c, gia Ä‘Ã¬nh', reading: 'ã‚¾ã‚¯'},
        {kanji: 'çˆ¶', meaning: 'bá»‘', reading: 'ã¡ã¡'},
        {kanji: 'æ¯', meaning: 'máº¹', reading: 'ã¯ã¯'},
        {kanji: 'å…„', meaning: 'anh trai', reading: 'ã‚ã«'},
        {kanji: 'å¼Ÿ', meaning: 'em trai', reading: 'ãŠã¨ã†ã¨'},
        {kanji: 'å§‰', meaning: 'chá»‹ gÃ¡i', reading: 'ã‚ã­'},
        {kanji: 'å¦¹', meaning: 'em gÃ¡i', reading: 'ã„ã‚‚ã†ã¨'},
        {kanji: 'çŠ¬', meaning: 'chÃ³', reading: 'ã„ã¬'},
        {kanji: 'é«˜', meaning: 'cao', reading: 'ãŸã‹'},
        {kanji: 'çŸ­', meaning: 'ngáº¯n', reading: 'ã¿ã˜ã‹'},
        {kanji: 'é•·', meaning: 'dÃ i', reading: 'ãªãŒ'}
    ],
    9: [
        {kanji: 'å¥½', meaning: 'thÃ­ch', reading: 'ã™'},
        {kanji: 'æ­Œ', meaning: 'bÃ i hÃ¡t', reading: 'ã†ãŸ'},
        {kanji: 'éŸ³', meaning: 'Ã¢m thanh', reading: 'ãŠã¨'},
        {kanji: 'æ¥½', meaning: 'vui, nháº¡c', reading: 'ãŸã®ãƒ»ã‚‰ã'},
        {kanji: 'è»Š', meaning: 'xe', reading: 'ãã‚‹ã¾'},
        {kanji: 'æ˜ ', meaning: 'chiáº¿u', reading: 'ã†ã¤'},
        {kanji: 'ç”»', meaning: 'tranh, phim', reading: 'ãŒ'},
        {kanji: 'æ—…', meaning: 'du lá»‹ch', reading: 'ãŸã³'},
        {kanji: 'æµ·', meaning: 'biá»ƒn', reading: 'ã†ã¿'},
        {kanji: 'å¤–', meaning: 'ngoÃ i', reading: 'ãã¨'}
    ],
    10: [
        {kanji: 'é§…', meaning: 'ga tÃ u', reading: 'ãˆã'},
        {kanji: 'ä¸Š', meaning: 'trÃªn', reading: 'ã†ãˆ'},
        {kanji: 'ä¸‹', meaning: 'dÆ°á»›i', reading: 'ã—ãŸ'},
        {kanji: 'åœ°', meaning: 'Ä‘áº¥t', reading: 'ã¡'},
        {kanji: 'å›³', meaning: 'báº£n Ä‘á»“', reading: 'ãš'},
        {kanji: 'é¤¨', meaning: 'quÃ¡n', reading: 'ã‹ã‚“'},
        {kanji: 'å³', meaning: 'pháº£i', reading: 'ã¿ã'},
        {kanji: 'å·¦', meaning: 'trÃ¡i', reading: 'ã²ã ã‚Š'},
        {kanji: 'é“', meaning: 'Ä‘Æ°á»ng', reading: 'ã¿ã¡'},
        {kanji: 'èµ·', meaning: 'dáº­y', reading: 'ãŠ'},
        {kanji: 'æ­©', meaning: 'Ä‘i bá»™', reading: 'ã‚ã‚‹'},
        {kanji: 'ä¹—', meaning: 'lÃªn (xe)', reading: 'ã®'}
    ],
    11: [
        {kanji: 'å§‹', meaning: 'báº¯t Ä‘áº§u', reading: 'ã¯ã˜'},
        {kanji: 'çµ‚', meaning: 'káº¿t thÃºc', reading: 'ãŠ'},
        {kanji: 'å‹‰', meaning: 'cá»‘ gáº¯ng', reading: 'ã¹ã‚“'},
        {kanji: 'å¼·', meaning: 'máº¡nh, há»c', reading: 'ã¤ã‚ˆãƒ»ãã‚‡ã†'},
        {kanji: 'æœ', meaning: 'buá»•i sÃ¡ng', reading: 'ã‚ã•'},
        {kanji: 'æ˜¼', meaning: 'buá»•i trÆ°a', reading: 'ã²ã‚‹'},
        {kanji: 'å¤œ', meaning: 'buá»•i tá»‘i', reading: 'ã‚ˆã‚‹'}
    ]
};

let currentTest = {
    lesson: 8,
    questions: [],
    currentIndex: 0,
    score: 0,
    answers: []
};

function loadKanjiTest() {
    const lesson = document.getElementById('lessonSelect').value;
    currentTest.lesson = lesson;
}

function startKanjiTest() {
    const lesson = currentTest.lesson;
    const allKanji = KANJI_DATA[lesson];
    
    // Random 5 kanji
    const shuffled = [...allKanji].sort(() => 0.5 - Math.random());
    currentTest.questions = shuffled.slice(0, 5);
    currentTest.currentIndex = 0;
    currentTest.score = 0;
    currentTest.answers = [];
    
    // Show test area
    document.getElementById('testArea').style.display = 'block';
    document.getElementById('resultArea').style.display = 'none';
    
    showQuestion();
}

function showQuestion() {
    const question = currentTest.questions[currentTest.currentIndex];
    const questionNum = currentTest.currentIndex + 1;
    
    document.getElementById('questionTitle').textContent = `CÃ¢u ${questionNum}/5`;
    document.getElementById('kanjiDisplay').textContent = question.kanji;
    
    // Generate options (1 correct + 3 wrong) - using reading instead of meaning
    const allKanji = KANJI_DATA[currentTest.lesson];
    const wrongOptions = allKanji
        .filter(k => k.kanji !== question.kanji)
        .sort(() => 0.5 - Math.random())
        .slice(0, 3);
    
    const options = [question, ...wrongOptions].sort(() => 0.5 - Math.random());
    
    const optionsArea = document.getElementById('optionsArea');
    optionsArea.innerHTML = '';
    
    options.forEach((opt, index) => {
        const button = document.createElement('button');
        button.className = 'option-button';
        const span = document.createElement('span');
        span.textContent = opt.reading; // Show furigana instead of meaning
        button.appendChild(span);
        button.onclick = () => selectAnswer(opt.kanji === question.kanji, button);
        optionsArea.appendChild(button);
    });
}

function selectAnswer(isCorrect, button) {
    // Disable all buttons
    const buttons = document.querySelectorAll('.option-button');
    buttons.forEach(btn => btn.disabled = true);
    
    // Mark correct/wrong
    if (isCorrect) {
        button.classList.add('correct');
        currentTest.score++;
    } else {
        button.classList.add('wrong');
        // Highlight correct answer
        const question = currentTest.questions[currentTest.currentIndex];
        buttons.forEach(btn => {
            if (btn.textContent === question.reading) {
                btn.classList.add('correct');
            }
        });
    }
    
    // Save answer
    currentTest.answers.push({
        kanji: currentTest.questions[currentTest.currentIndex].kanji,
        reading: currentTest.questions[currentTest.currentIndex].reading,
        correct: isCorrect
    });
    
    // Next question after delay
    setTimeout(() => {
        currentTest.currentIndex++;
        if (currentTest.currentIndex < 5) {
            showQuestion();
        } else {
            showResult();
        }
    }, 1500);
}

function showResult() {
    document.getElementById('testArea').style.display = 'none';
    document.getElementById('resultArea').style.display = 'block';
    
    const scoreTitle = document.getElementById('scoreTitle');
    const resultDetails = document.getElementById('resultDetails');
    
    scoreTitle.textContent = `${currentTest.score}/5`;
    
    let html = '';
    currentTest.answers.forEach((ans, i) => {
        html += `<div class="result-item ${ans.correct ? 'correct' : 'wrong'}">
            <div class="result-kanji">${ans.kanji}</div>
            <div class="result-answer correct-answer">âœ“ ${ans.reading}</div>
        </div>`;
    });
    
    resultDetails.innerHTML = html;
}

// ===== READING QUIZ FUNCTIONS =====
let quizData = [];
let currentQuizIndex = 0;
let quizScore = 0;
let selectedAnswer = null;
let userAnswers = [];

// 42 cÃ¢u há»i kiá»ƒu thi FE - Ä‘a dáº¡ng dáº¡ng cÃ¢u há»i
const readingQuizData = [
    // PHáº¦N 1: NGá»® PHÃP - BÃ i 8 (10 cÃ¢u)
    {
        type: "grammar",
        question: "ã‚ãŸã—ã¯ ãƒ›ãƒ¼ãƒãƒŸãƒ³ï¼¿ï¼¿ ã™ã‚“ã§ã„ã¾ã™ã€‚",
        options: ["ã«", "ã§", "ã‚’", "ã¸"],
        correct: 0,
        explanation: "DÃ¹ng ã« vá»›i ã™ã‚“ã§ã„ã¾ã™ Ä‘á»ƒ chá»‰ nÆ¡i sinh sá»‘ng"
    },
    {
        type: "grammar",
        question: "ã‹ããã¯ 4ã«ã‚“ï¼¿ï¼¿ ã™ã‚“ã§ã„ã¾ã™ã€‚",
        options: ["ã«", "ã§", "ãŒ", "ã‚’"],
        correct: 1,
        explanation: "DÃ¹ng ã§ Ä‘á»ƒ chá»‰ sá»‘ ngÆ°á»i sá»‘ng cÃ¹ng"
    },
    {
        type: "grammar",
        question: "ã„ã¬ï¼¿ï¼¿ 1ã´ã ã„ã¾ã™ã€‚",
        options: ["ã¯", "ã‚’", "ãŒ", "ã«"],
        correct: 2,
        explanation: "DÃ¹ng ãŒ vá»›i ã„ã¾ã™ khi nÃ³i vá» sá»± tá»“n táº¡i"
    },
    {
        type: "grammar",
        question: "ã‹ã¿ãŒ ãªãŒã„ï¼¿ï¼¿ã€ãã‚Œã„ã§ã™ã€‚",
        options: ["ã¦", "ãã¦", "ã§", "ã«"],
        correct: 1,
        explanation: "TÃ­nh tá»« ã„ ná»‘i báº±ng ãã¦"
    },
    {
        type: "grammar",
        question: "ã—ã‚“ã›ã¤ï¼¿ï¼¿ã€ã‚„ã•ã—ã„ã§ã™ã€‚",
        options: ["ãã¦", "ã¦", "ã§", "ã«"],
        correct: 2,
        explanation: "TÃ­nh tá»« ãª ná»‘i báº±ng ã§"
    },
    {
        type: "grammar",
        question: "ã¡ã¡ã¯ ã‚ãŸã—ï¼¿ï¼¿ ã»ã‚“ã‚’ ãã‚Œã¾ã—ãŸã€‚",
        options: ["ã‚’", "ã«", "ãŒ", "ã§"],
        correct: 1,
        explanation: "DÃ¹ng ã« Ä‘á»ƒ chá»‰ ngÆ°á»i nháº­n trong cÃ¢u ãã‚Œã‚‹"
    },
    {
        type: "grammar",
        question: "ã‚ãŸã—ã¯ ã¨ã‚‚ã ã¡ï¼¿ï¼¿ ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã‚’ ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚",
        options: ["ã‚’", "ãŒ", "ã«", "ã§"],
        correct: 2,
        explanation: "DÃ¹ng ã« Ä‘á»ƒ chá»‰ ngÆ°á»i cho trong cÃ¢u ã‚‚ã‚‰ã†"
    },
    {
        type: "vocabulary",
        question: "ã€ŒèƒŒãŒé«˜ã„ã€ã®æ„å‘³ã¯ï¼Ÿ",
        options: ["Cao", "Tháº¥p", "DÃ i", "Ngáº¯n"],
        correct: 0,
        explanation: "ã›ãŒ ãŸã‹ã„ = cao (vá» chiá»u cao)"
    },
    {
        type: "vocabulary",
        question: "ã€Œå®¶æ—ã€ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚",
        options: ["ã‹ãã", "ã„ãˆãã", "ã‹ãã", "ã‘ãã"],
        correct: 0,
        explanation: "å®¶æ— Ä‘á»c lÃ  ã‹ãã (gia Ä‘Ã¬nh)"
    },
    {
        type: "grammar",
        question: "A: ã©ã‚“ãª ã²ã¨ã§ã™ã‹ã€‚B: ã‚„ã•ã—ã„ï¼¿ï¼¿ ã§ã™ã€‚",
        options: ["ã®", "ãª", "ã²ã¨", "ã‚‚ã®"],
        correct: 2,
        explanation: "Tráº£ lá»i báº±ng ã‚„ã•ã—ã„ ã²ã¨ ã§ã™"
    },

    // PHáº¦N 2: NGá»® PHÃP - BÃ i 9 (11 cÃ¢u)
    {
        type: "grammar",
        question: "ã‚ãŸã—ã® ã—ã‚…ã¿ã¯ ãŠã‚“ãŒãã‚’ ããï¼¿ï¼¿ ã§ã™ã€‚",
        options: ["ã®", "ã“ã¨", "ã‚‚ã®", "ã²ã¨"],
        correct: 1,
        explanation: "DÃ¹ng ã“ã¨ Ä‘á»ƒ danh tá»« hÃ³a Ä‘á»™ng tá»« khi nÃ³i vá» sá»Ÿ thÃ­ch"
    },
    {
        type: "grammar",
        question: "1ã—ã‚…ã†ã‹ã‚“ï¼¿ï¼¿ 2ã‹ã„ ãƒ†ãƒ‹ã‚¹ã‚’ ã—ã¾ã™ã€‚",
        options: ["ã§", "ã‚’", "ã«", "ãŒ"],
        correct: 2,
        explanation: "DÃ¹ng ã« vá»›i táº§n suáº¥t: 1ã—ã‚…ã†ã‹ã‚“ã« 2ã‹ã„"
    },
    {
        type: "vocabulary",
        question: "ã€Œæ˜ ç”»ã‚’è¦‹ã‚‹ã€ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚",
        options: ["ãˆã„ãŒã‚’ ã¿ã‚‹", "ãˆãŒã‚’ ã¿ã‚‹", "ãˆã„ã‹ã‚’ ã¿ã‚‹", "ãŒãˆã„ã‚’ ã¿ã‚‹"],
        correct: 0,
        explanation: "æ˜ ç”» Ä‘á»c lÃ  ãˆã„ãŒ (phim)"
    },
    {
        type: "grammar",
        question: "ãˆã„ãŒã‚’ ã¿ï¼¿ï¼¿ã€ã”ã¯ã‚“ã‚’ ãŸã¹ã¾ã—ãŸã€‚",
        options: ["ã‚‹", "ãŸ", "ã¦", "ã«"],
        correct: 2,
        explanation: "DÃ¹ng ã¦ Ä‘á»ƒ ná»‘i cÃ¡c hÃ nh Ä‘á»™ng theo thá»© tá»±"
    },
    {
        type: "vocabulary",
        question: "ã€Œæ—…è¡Œã€ã®æ„å‘³ã¯ï¼Ÿ",
        options: ["Du lá»‹ch", "Biá»ƒn", "Xe", "Nháº¡c"],
        correct: 0,
        explanation: "ã‚Šã‚‡ã“ã† = du lá»‹ch"
    },
    {
        type: "grammar",
        question: "A: ã©ã†ã‚„ã£ã¦ ãŒã£ã“ã†ã¸ ã„ãã¾ã™ã‹ã€‚B: ãƒã‚¹ï¼¿ï¼¿ ã„ãã¾ã™ã€‚",
        options: ["ã‚’", "ã«", "ã§", "ãŒ"],
        correct: 2,
        explanation: "DÃ¹ng ã§ Ä‘á»ƒ chá»‰ phÆ°Æ¡ng tiá»‡n"
    },
    {
        type: "vocabulary",
        question: "ã€Œå¥½ãã€ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚",
        options: ["ã™ã", "ã“ã†ã", "ã‚ˆã—ã", "ã“ã"],
        correct: 0,
        explanation: "å¥½ã Ä‘á»c lÃ  ã™ã (thÃ­ch)"
    },
    {
        type: "grammar",
        question: "ã‚Šã‚‡ã†ã‚Šï¼¿ï¼¿ ã§ãã¾ã™ã€‚",
        options: ["ã‚’", "ã«", "ãŒ", "ã§"],
        correct: 2,
        explanation: "DÃ¹ng ãŒ vá»›i ã§ãã¾ã™"
    },
    {
        type: "reading",
        passage: "ã‚ãŸã—ã¯ ã¾ã„ã«ã¡ 6ã˜ã« ãŠãã¾ã™ã€‚ã‚ã•ã”ã¯ã‚“ã‚’ ãŸã¹ã¦ã€ãŒã£ã“ã†ã¸ ã„ãã¾ã™ã€‚",
        question: "ãªã‚“ã˜ã« ãŠãã¾ã™ã‹ã€‚",
        options: ["5ã˜", "6ã˜", "7ã˜", "8ã˜"],
        correct: 1,
        explanation: "6ã˜ã« ãŠãã¾ã™ = dáº­y lÃºc 6 giá»"
    },
    {
        type: "vocabulary",
        question: "ã€ŒéŸ³æ¥½ã€ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚",
        options: ["ãŠã¨ãŒã", "ãŠã‚“ãŒã", "ã­ãŒã", "ã„ã‚“ãŒã"],
        correct: 1,
        explanation: "éŸ³æ¥½ Ä‘á»c lÃ  ãŠã‚“ãŒã (Ã¢m nháº¡c)"
    },
    {
        type: "grammar",
        question: "A: ã—ã‚…ã†ã¾ã¤ ãªã«ã‚’ ã—ã¾ã™ã‹ã€‚B: ã»ã‚“ã‚’ ã‚ˆã‚“ï¼¿ï¼¿ã€ãˆã„ãŒã‚’ ã¿ãŸã‚Š ã—ã¾ã™ã€‚",
        options: ["ã§", "ã ã‚Š", "ãŸã‚Š", "ã¦"],
        correct: 2,
        explanation: "DÃ¹ng ãŸã‚Š Ä‘á»ƒ liá»‡t kÃª hÃ nh Ä‘á»™ng khÃ´ng theo thá»© tá»±"
    },

    // PHáº¦N 3: NGá»® PHÃP - BÃ i 10 (10 cÃ¢u)
    {
        type: "grammar",
        question: "A: ã‚‚ã† ã—ã‚…ãã ã„ã‚’ ã—ã¾ã—ãŸã‹ã€‚B: ã„ã„ãˆã€ã¾ã ï¼¿ï¼¿ã€‚",
        options: ["ã—ã¾ã—ãŸ", "ã—ã¾ã™", "ã—ã¦ã„ã¾ã›ã‚“", "ã—ã¾ã›ã‚“"],
        correct: 2,
        explanation: "ã¾ã  + thá»ƒ phá»§ Ä‘á»‹nh tiáº¿p diá»…n = váº«n chÆ°a"
    },
    {
        type: "grammar",
        question: "ã‚³ãƒ³ãƒ“ãƒ‹ã¸ ã„ã£ã¦ï¼¿ï¼¿ã€‚",
        options: ["ãã ã•ã„", "ãã¾ã™", "ã„ãã¾ã™", "ã‚ã‚Šã¾ã™"],
        correct: 1,
        explanation: "Vã¦ãã¾ã™ = Ä‘i lÃ m gÃ¬ rá»“i quay láº¡i"
    },
    {
        type: "grammar",
        question: "ã¾ã©ã‹ã‚‰ ã‚„ã¾ï¼¿ï¼¿ ã¿ãˆã¾ã™ã€‚",
        options: ["ã‚’", "ã«", "ãŒ", "ã§"],
        correct: 2,
        explanation: "DÃ¹ng ãŒ vá»›i ã¿ãˆã¾ã™ (nhÃ¬n tháº¥y)"
    },
    {
        type: "grammar",
        question: "ã—ã‚ƒã—ã‚“ã‚’ ã¨ã£ï¼¿ï¼¿ ã„ã„ã§ã™ã‹ã€‚",
        options: ["ã¦", "ã¦ã‚‚", "ãŸã‚‰", "ã°"],
        correct: 1,
        explanation: "Vã¦ã‚‚ã„ã„ã§ã™ã‹ = xin phÃ©p lÃ m gÃ¬"
    },
    {
        type: "grammar",
        question: "ã“ã“ã§ ãŸã°ã“ã‚’ ã™ã‚ï¼¿ï¼¿ ãã ã•ã„ã€‚",
        options: ["ã£ã¦", "ãªã„ã§", "ãªãã¦", "ãªã„"],
        correct: 1,
        explanation: "Vãªã„ã§ãã ã•ã„ = xin Ä‘á»«ng lÃ m gÃ¬"
    },
    {
        type: "vocabulary",
        question: "ã€Œé§…ã€ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚",
        options: ["ãˆã", "ã„ã", "ãˆã„", "ã†ãˆã"],
        correct: 0,
        explanation: "é§… Ä‘á»c lÃ  ãˆã (ga)"
    },
    {
        type: "grammar",
        question: "ã“ã†ãˆã‚“ã‚’ï¼¿ï¼¿ ã„ã¾ã™ã€‚",
        options: ["ã‚ã‚‹ã„ã¦", "ã‚ã‚‹ã", "ã‚ã‚‹ã", "ã‚ã‚‹ã‘"],
        correct: 0,
        explanation: "ã‚’ + Ä‘á»™ng tá»« di chuyá»ƒn (ã‚ã‚‹ã„ã¦ ã„ã¾ã™ = Ä‘ang Ä‘i bá»™ qua)"
    },
    {
        type: "reading",
        passage: "ã‚«ãƒ•ã‚§ã‹ã‚‰ ã†ã¿ãŒ ã¿ãˆã¾ã™ã€‚ã¨ã¦ã‚‚ ãã‚Œã„ã§ã™ã€‚",
        question: "ãªã«ãŒ ã¿ãˆã¾ã™ã‹ã€‚",
        options: ["ã‚„ã¾", "ã†ã¿", "ãã‚‰", "ã‹ã‚"],
        correct: 1,
        explanation: "ã†ã¿ãŒ ã¿ãˆã¾ã™ = nhÃ¬n tháº¥y biá»ƒn"
    },
    {
        type: "vocabulary",
        question: "ã€Œé“ã€ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚",
        options: ["ã©ã†", "ã¿ã¡", "ã©ãŠ", "ã¨ã†"],
        correct: 1,
        explanation: "é“ Ä‘á»c lÃ  ã¿ã¡ (Ä‘Æ°á»ng)"
    },
    {
        type: "grammar",
        question: "ã“ã“ã§ ãŠã‚ˆãï¼¿ï¼¿ãŒ ã§ãã¾ã™ã€‚",
        options: ["ã®", "ã“ã¨", "ã‚‚ã®", "ã²ã¨"],
        correct: 1,
        explanation: "Vã‚‹ã“ã¨ãŒã§ãã¾ã™ = cÃ³ thá»ƒ lÃ m gÃ¬"
    },

    // PHáº¦N 4: NGá»® PHÃP - BÃ i 11 (11 cÃ¢u)
    {
        type: "grammar",
        question: "ã‚ãŸã—ã¯ ã•ã‹ãªã¯ ã™ãã§ã™ï¼¿ï¼¿ã€ã«ãã¯ ã™ãã˜ã‚ƒã‚ã‚Šã¾ã›ã‚“ã€‚",
        options: ["ãã—ã¦", "ã§ã‚‚", "ãŒ", "ã‹ã‚‰"],
        correct: 2,
        explanation: "DÃ¹ng ãŒ Ä‘á»ƒ ná»‘i cÃ¢u Ä‘á»‘i láº­p"
    },
    {
        type: "grammar",
        question: "ã¾ã„ã«ã¡ ã«ã»ã‚“ã”ã‚’ ã¹ã‚“ãã‚‡ã†ã—ï¼¿ï¼¿ ã„ã¾ã™ã€‚",
        options: ["ã¦", "ãŸ", "ã«", "ã§"],
        correct: 0,
        explanation: "Vã¦ã„ã¾ã™ = Ä‘ang lÃ m gÃ¬ (thÃ³i quen, tiáº¿p diá»…n)"
    },
    {
        type: "grammar",
        question: "ã‚„ã™ã¿ã® ã²ã¯ ã»ã‚“ã‚’ ã‚ˆã‚“ï¼¿ï¼¿ã€ãŠã‚“ãŒãã‚’ ãã„ãŸã‚Š ã—ã¾ã™ã€‚",
        options: ["ã§", "ã ã‚Š", "ãŸã‚Š", "ã¦"],
        correct: 2,
        explanation: "VãŸã‚Š VãŸã‚Š ã—ã¾ã™ = lÃ m viá»‡c nÃ y viá»‡c kia"
    },
    {
        type: "grammar",
        question: "ã²ã¾ï¼¿ï¼¿ ã¨ãã€ãªã«ã‚’ ã—ã¾ã™ã‹ã€‚",
        options: ["ã®", "ãª", "ã ", "ã§"],
        correct: 1,
        explanation: "TÃ­nh tá»« ãª + ãª + ã¨ã"
    },
    {
        type: "grammar",
        question: "ã•ã‚€ã„ ã¨ãã€ã‚ãŸãŸã‹ã„ ãŠã¡ã‚ƒï¼¿ï¼¿ ã®ã¿ã¾ã™ã€‚",
        options: ["ãŒ", "ã‚’", "ã«", "ã§"],
        correct: 1,
        explanation: "DÃ¹ng ã‚’ cho tÃ¢n ngá»¯ vá»›i ã®ã¿ã¾ã™"
    },
    {
        type: "vocabulary",
        question: "ã€Œèµ·ãã‚‹ã€ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚",
        options: ["ãŠã“ã‚‹", "ãŠãã‚‹", "ãŠã¡ã‚‹", "ã‚ãã‚‹"],
        correct: 1,
        explanation: "èµ·ãã‚‹ Ä‘á»c lÃ  ãŠãã‚‹ (thá»©c dáº­y)"
    },
    {
        type: "reading",
        passage: "ã‚ã—ãŸ ãƒ†ã‚¹ãƒˆãŒ ã‚ã‚Šã¾ã™ã€‚ã ã‹ã‚‰ ãã‚‡ã†ã¯ ã¹ã‚“ãã‚‡ã†ã—ã¾ã™ã€‚",
        question: "ã„ã¤ ãƒ†ã‚¹ãƒˆãŒ ã‚ã‚Šã¾ã™ã‹ã€‚",
        options: ["ãã‚‡ã†", "ã‚ã—ãŸ", "ãã®ã†", "ã‚ã•ã£ã¦"],
        correct: 1,
        explanation: "ã‚ã—ãŸ ãƒ†ã‚¹ãƒˆãŒ ã‚ã‚Šã¾ã™ = ngÃ y mai cÃ³ kiá»ƒm tra"
    },
    {
        type: "grammar",
        question: "A: ã©ã†ã—ã¾ã—ãŸã‹ã€‚B: ã‚ãŸã¾ï¼¿ï¼¿ ã„ãŸã„ã§ã™ã€‚",
        options: ["ã‚’", "ã«", "ãŒ", "ã§"],
        correct: 2,
        explanation: "DÃ¹ng ãŒ vá»›i tÃ­nh tá»« (ã‚ãŸã¾ãŒ ã„ãŸã„)"
    },
    {
        type: "vocabulary",
        question: "ã€Œæœã€ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚",
        options: ["ã‚ˆã‚‹", "ã²ã‚‹", "ã‚ã•", "ã‚†ã†"],
        correct: 2,
        explanation: "æœ Ä‘á»c lÃ  ã‚ã• (buá»•i sÃ¡ng)"
    },
    {
        type: "grammar",
        question: "ã«ã»ã‚“ã”ãŒ ã˜ã‚‡ã†ãšï¼¿ï¼¿ ãªã‚Šã¾ã—ãŸã€‚",
        options: ["ã‚’", "ãŒ", "ã«", "ã§"],
        correct: 2,
        explanation: "ã«ãªã‚Šã¾ã™ = trá»Ÿ nÃªn (dÃ¹ng vá»›i tÃ­nh tá»« ãª, danh tá»«)"
    },
    {
        type: "reading",
        passage: "ã‚ãŸã—ã¯ 7ã˜ã« ãŠãã¾ã™ã€‚ã‚ã«ã¯ 6ã˜ã« ãŠãã¾ã™ã€‚ã¡ã¡ã¯ 5ã˜ã« ãŠãã¾ã™ã€‚",
        question: "ã ã‚ŒãŒ ã„ã¡ã°ã‚“ ã¯ã‚„ã ãŠãã¾ã™ã‹ã€‚",
        options: ["ã‚ãŸã—", "ã‚ã«", "ã¡ã¡", "ã¯ã¯"],
        correct: 2,
        explanation: "ã¡ã¡ã¯ 5ã˜ã« ãŠãã¾ã™ = bá»‘ dáº­y lÃºc 5 giá» (sá»›m nháº¥t)"
    }
];

function startReadingQuiz() {
    quizData = [...readingQuizData];
    currentQuizIndex = 0;
    quizScore = 0;
    selectedAnswer = null;
    userAnswers = [];
    
    document.querySelector('.grammar-item').style.display = 'none';
    document.getElementById('quizArea').style.display = 'block';
    document.getElementById('quizResult').style.display = 'none';
    
    showQuizQuestion();
}

function showQuizQuestion() {
    const question = quizData[currentQuizIndex];
    
    document.getElementById('currentQuestion').textContent = `CÃ¢u ${currentQuizIndex + 1}/42`;
    document.getElementById('quizScore').textContent = `Äiá»ƒm: ${quizScore}`;
    document.getElementById('progressFill').style.width = `${((currentQuizIndex) / 42) * 100}%`;
    
    // Hiá»ƒn thá»‹ Ä‘oáº¡n vÄƒn (náº¿u cÃ³) hoáº·c áº©n Ä‘i
    const passageEl = document.querySelector('.reading-passage');
    if (question.passage) {
        passageEl.style.display = 'block';
        document.getElementById('passageText').textContent = question.passage;
    } else {
        passageEl.style.display = 'none';
    }
    
    document.getElementById('questionText').textContent = question.question;
    
    const optionsHtml = question.options.map((option, index) => `
        <button class="quiz-option" onclick="selectQuizAnswer(${index})">
            ${String.fromCharCode(65 + index)}. ${option}
        </button>
    `).join('');
    
    document.getElementById('quizOptions').innerHTML = optionsHtml;
    document.getElementById('answerFeedback').style.display = 'none';
    document.getElementById('submitAnswer').style.display = 'inline-block';
    document.getElementById('nextQuestion').style.display = 'none';
    
    selectedAnswer = null;
}

function selectQuizAnswer(index) {
    if (selectedAnswer !== null) return;
    
    const options = document.querySelectorAll('.quiz-option');
    options.forEach(opt => opt.classList.remove('selected'));
    options[index].classList.add('selected');
    selectedAnswer = index;
}

function submitQuizAnswer() {
    if (selectedAnswer === null) {
        alert('Vui lÃ²ng chá»n má»™t Ä‘Ã¡p Ã¡n!');
        return;
    }
    
    const question = quizData[currentQuizIndex];
    const options = document.querySelectorAll('.quiz-option');
    const feedback = document.getElementById('answerFeedback');
    
    // LÆ°u cÃ¢u tráº£ lá»i
    userAnswers[currentQuizIndex] = selectedAnswer;
    
    // Kiá»ƒm tra Ä‘Ã¡p Ã¡n
    if (selectedAnswer === question.correct) {
        quizScore++;
        feedback.innerHTML = `<span class="correct">âœ“ ÄÃºng rá»“i!</span><p>${question.explanation}</p>`;
        options[selectedAnswer].classList.add('correct');
    } else {
        feedback.innerHTML = `<span class="incorrect">âœ— Sai rá»“i!</span><p>ÄÃ¡p Ã¡n Ä‘Ãºng: ${String.fromCharCode(65 + question.correct)}. ${question.options[question.correct]}</p><p>${question.explanation}</p>`;
        options[selectedAnswer].classList.add('incorrect');
        options[question.correct].classList.add('correct');
    }
    
    feedback.style.display = 'block';
    document.getElementById('submitAnswer').style.display = 'none';
    document.getElementById('nextQuestion').style.display = 'inline-block';
    document.getElementById('quizScore').textContent = `Äiá»ƒm: ${quizScore}`;
}

function nextQuizQuestion() {
    currentQuizIndex++;
    
    if (currentQuizIndex < quizData.length) {
        showQuizQuestion();
    } else {
        showQuizResult();
    }
}

function showQuizResult() {
    document.getElementById('quizArea').style.display = 'none';
    document.getElementById('quizResult').style.display = 'block';
    
    const percentage = ((quizScore / 42) * 100).toFixed(1);
    document.getElementById('finalScore').textContent = `${quizScore}/42 (${percentage}%)`;
    
    let grade = '';
    if (percentage >= 90) grade = 'Xuáº¥t sáº¯c! ğŸ†';
    else if (percentage >= 80) grade = 'Giá»i! ğŸŒŸ';
    else if (percentage >= 70) grade = 'KhÃ¡ tá»‘t! ğŸ‘';
    else if (percentage >= 60) grade = 'Trung bÃ¬nh ğŸ“š';
    else grade = 'Cáº§n cá»‘ gáº¯ng thÃªm! ğŸ’ª';
    
    document.getElementById('gradeText').textContent = grade;
}

function restartQuiz() {
    startReadingQuiz();
}

function backToQuizPanel() {
    document.getElementById('quizResult').style.display = 'none';
    document.querySelector('.grammar-item').style.display = 'block';
}
        options: ["ã»ã‚“", "ã‚±ãƒ¼ã‚­", "ã‹ã°ã‚“", "ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ"],
        correct: 2,
        explanation: "Bá»‘ táº·ng cÃ¡i cáº·p (ã¡ã¡ã¯ ã‹ã°ã‚“ã‚’ ãã‚Œã¾ã—ãŸ)"
    },
    {
        passage: `ãã®ã†ã¯ ãŸã‚“ã˜ã‚‡ã†ã³ã§ã—ãŸã€‚ã¡ã¡ã¯ ã‚ãŸã—ã« ã‚ãŸã‚‰ã—ã„ ã‹ã°ã‚“ã‚’ ãã‚Œã¾ã—ãŸã€‚ã¯ã¯ã¯ ã‚±ãƒ¼ã‚­ã‚’ ã¤ãã£ã¦ ãã‚Œã¾ã—ãŸã€‚ã‚ã«ã¯ ã‚ãŸã—ã« ã»ã‚“ã‚’ ã‚ã’ã¾ã—ãŸã€‚ã„ã‚‚ã†ã¨ã‚‚ ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã‚’ ãã‚Œã¾ã—ãŸã€‚ã¨ã¦ã‚‚ ãŸã®ã—ã„ ã„ã¡ã«ã¡ã§ã—ãŸã€‚`,
        question: "ã ã‚ŒãŒ ã‚±ãƒ¼ã‚­ã‚’ ã¤ãã‚Šã¾ã—ãŸã‹ã€‚",
        options: ["ã¡ã¡", "ã¯ã¯", "ã‚ã«", "ã„ã‚‚ã†ã¨"],
        correct: 1,
        explanation: "Máº¹ lÃ m bÃ¡nh (ã¯ã¯ã¯ ã‚±ãƒ¼ã‚­ã‚’ ã¤ãã£ã¦ ãã‚Œã¾ã—ãŸ)"
    },
    {
        passage: `ã‚„ã¾ã ã•ã‚“ã¯ ã‚ãŸã—ã® ã›ã‚“ã±ã„ã§ã™ã€‚ã ã„ãŒãã§ ã¹ã‚“ãã‚‡ã†ã—ã¦ ã„ã¾ã™ã€‚ã‚„ã¾ã ã•ã‚“ã¯ ã—ã‚“ã›ã¤ã§ã€ã‚ãŸã¾ãŒ ã„ã„ã§ã™ã€‚ã¾ã„ã«ã¡ ã¨ã—ã‚‡ã‹ã‚“ã§ ã¹ã‚“ãã‚‡ã†ã—ã¦ ã„ã¾ã™ã€‚ã‚„ã¾ã ã•ã‚“ã¯ ã‚‰ã„ã­ã‚“ ã«ã»ã‚“ã¸ ã‚Šã‚…ã†ãŒãã—ã¾ã™ã€‚`,
        question: "ã‚„ã¾ã ã•ã‚“ã¯ ã©ã“ã§ ã¹ã‚“ãã‚‡ã†ã—ã¦ ã„ã¾ã™ã‹ã€‚",
        options: ["ãŒã£ã“ã†", "ã†ã¡", "ã¨ã—ã‚‡ã‹ã‚“", "ã“ã†ãˆã‚“"],
        correct: 2,
        explanation: "Yamada há»c á»Ÿ thÆ° viá»‡n (ã¨ã—ã‚‡ã‹ã‚“ã§ ã¹ã‚“ãã‚‡ã†ã—ã¦ ã„ã¾ã™)"
    },
    {
        passage: `ã‚„ã¾ã ã•ã‚“ã¯ ã‚ãŸã—ã® ã›ã‚“ã±ã„ã§ã™ã€‚ã ã„ãŒãã§ ã¹ã‚“ãã‚‡ã†ã—ã¦ ã„ã¾ã™ã€‚ã‚„ã¾ã ã•ã‚“ã¯ ã—ã‚“ã›ã¤ã§ã€ã‚ãŸã¾ãŒ ã„ã„ã§ã™ã€‚ã¾ã„ã«ã¡ ã¨ã—ã‚‡ã‹ã‚“ã§ ã¹ã‚“ãã‚‡ã†ã—ã¦ ã„ã¾ã™ã€‚ã‚„ã¾ã ã•ã‚“ã¯ ã‚‰ã„ã­ã‚“ ã«ã»ã‚“ã¸ ã‚Šã‚…ã†ãŒãã—ã¾ã™ã€‚`,
        question: "ã‚„ã¾ã ã•ã‚“ã¯ ã„ã¤ ã«ã»ã‚“ã¸ ã„ãã¾ã™ã‹ã€‚",
        options: ["ãã‚‡ã†", "ã‚ã—ãŸ", "ã‚‰ã„ã—ã‚…ã†", "ã‚‰ã„ã­ã‚“"],
        correct: 3,
        explanation: "Yamada sang Nháº­t nÄƒm sau (ã‚‰ã„ã­ã‚“ ã«ã»ã‚“ã¸ ã‚Šã‚…ã†ãŒãã—ã¾ã™)"
    },
    {
        passage: `ã‚ãŸã—ã® ã„ã‚‚ã†ã¨ã¯ ã“ã†ã“ã†ã›ã„ã§ã™ã€‚ã„ã‚‚ã†ã¨ã¯ ã‹ã‚ã„ãã¦ã€ã’ã‚“ãã§ã™ã€‚ã„ã‚‚ã†ã¨ã¯ ã†ãŸã‚’ ã†ãŸã†ã“ã¨ãŒ ã™ãã§ã™ã€‚ã¾ã„ã«ã¡ ã‚«ãƒ©ã‚ªã‚±ã§ ã‚Œã‚“ã—ã‚…ã†ã—ã¦ ã„ã¾ã™ã€‚ã„ã‚‚ã†ã¨ã® ã‚†ã‚ã¯ ã‹ã—ã‚…ã« ãªã‚‹ã“ã¨ã§ã™ã€‚`,
        question: "ã„ã‚‚ã†ã¨ã¯ ãªã«ãŒ ã™ãã§ã™ã‹ã€‚",
        options: ["ãƒ€ãƒ³ã‚¹", "ã†ãŸ", "ã‚¹ãƒãƒ¼ãƒ„", "ãˆã„ãŒ"],
        correct: 1,
        explanation: "Em gÃ¡i thÃ­ch hÃ¡t (ã†ãŸã‚’ ã†ãŸã†ã“ã¨ãŒ ã™ãã§ã™)"
    },
    {
        passage: `ã‚ãŸã—ã® ã„ã‚‚ã†ã¨ã¯ ã“ã†ã“ã†ã›ã„ã§ã™ã€‚ã„ã‚‚ã†ã¨ã¯ ã‹ã‚ã„ãã¦ã€ã’ã‚“ãã§ã™ã€‚ã„ã‚‚ã†ã¨ã¯ ã†ãŸã‚’ ã†ãŸã†ã“ã¨ãŒ ã™ãã§ã™ã€‚ã¾ã„ã«ã¡ ã‚«ãƒ©ã‚ªã‚±ã§ ã‚Œã‚“ã—ã‚…ã†ã—ã¦ ã„ã¾ã™ã€‚ã„ã‚‚ã†ã¨ã® ã‚†ã‚ã¯ ã‹ã—ã‚…ã« ãªã‚‹ã“ã¨ã§ã™ã€‚`,
        question: "ã„ã‚‚ã†ã¨ã® ã‚†ã‚ã¯ ãªã‚“ã§ã™ã‹ã€‚",
        options: ["ã›ã‚“ã›ã„", "ã„ã—ã‚ƒ", "ã‹ã—ã‚…", "ã‹ã„ã—ã‚ƒã„ã‚“"],
        correct: 2,
        explanation: "Æ¯á»›c mÆ¡ cá»§a em gÃ¡i lÃ  trá»Ÿ thÃ nh ca sÄ© (ã‹ã—ã‚…ã« ãªã‚‹ã“ã¨)"
    },

    // BÃ i 9 - 11 cÃ¢u
    {
        passage: `ã‚ãŸã—ã® ã—ã‚…ã¿ã¯ ãŠã‚“ãŒãã‚’ ããã“ã¨ã§ã™ã€‚ã¾ã„ã«ã¡ 1ã˜ã‹ã‚“ ãã‚‰ã„ ãã„ã¦ ã„ã¾ã™ã€‚ãƒãƒƒãƒ—ã‚¹ãŒ ã™ãã§ã™ã€‚ã¨ãã©ã ã‚³ãƒ³ã‚µãƒ¼ãƒˆã¸ ã„ãã¾ã™ã€‚ãŠã‚“ãŒãã‚’ ããã¨ã€ã’ã‚“ãã« ãªã‚Šã¾ã™ã€‚ã¨ã‚‚ã ã¡ã¨ ã‚«ãƒ©ã‚ªã‚±ã¸ ã„ãã“ã¨ã‚‚ ã™ãã§ã™ã€‚`,
        question: "ã—ã‚…ã¿ã¯ ãªã‚“ã§ã™ã‹ã€‚",
        options: ["ã‚¹ãƒãƒ¼ãƒ„", "ã‚Šã‚‡ã†ã‚Š", "ãŠã‚“ãŒã", "ã©ãã—ã‚‡"],
        correct: 2,
        explanation: "Sá»Ÿ thÃ­ch lÃ  nghe nháº¡c (ã—ã‚…ã¿ã¯ ãŠã‚“ãŒãã‚’ ããã“ã¨ã§ã™)"
    },
    {
        passage: `ã‚ãŸã—ã® ã—ã‚…ã¿ã¯ ãŠã‚“ãŒãã‚’ ããã“ã¨ã§ã™ã€‚ã¾ã„ã«ã¡ 1ã˜ã‹ã‚“ ãã‚‰ã„ ãã„ã¦ ã„ã¾ã™ã€‚ãƒãƒƒãƒ—ã‚¹ãŒ ã™ãã§ã™ã€‚ã¨ãã©ã ã‚³ãƒ³ã‚µãƒ¼ãƒˆã¸ ã„ãã¾ã™ã€‚ãŠã‚“ãŒãã‚’ ããã¨ã€ã’ã‚“ãã« ãªã‚Šã¾ã™ã€‚ã¨ã‚‚ã ã¡ã¨ ã‚«ãƒ©ã‚ªã‚±ã¸ ã„ãã“ã¨ã‚‚ ã™ãã§ã™ã€‚`,
        question: "ã¾ã„ã«ã¡ ã©ã®ãã‚‰ã„ ãŠã‚“ãŒãã‚’ ããã¾ã™ã‹ã€‚",
        options: ["30ã·ã‚“", "1ã˜ã‹ã‚“", "2ã˜ã‹ã‚“", "3ã˜ã‹ã‚“"],
        correct: 1,
        explanation: "Nghe khoáº£ng 1 tiáº¿ng má»—i ngÃ y (ã¾ã„ã«ã¡ 1ã˜ã‹ã‚“ ãã‚‰ã„)"
    },
    {
        passage: `ã—ã‚…ã†ã¾ã¤ã¯ ã¨ã‚‚ã ã¡ã¨ ãˆã„ãŒã‚’ ã¿ã¾ã—ãŸã€‚ãˆã„ãŒã‹ã‚“ã¸ ã„ã£ã¦ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãˆã„ãŒã‚’ ã¿ã¾ã—ãŸã€‚ã¨ã¦ã‚‚ ãŠã‚‚ã—ã‚ã‹ã£ãŸã§ã™ã€‚ãã‚Œã‹ã‚‰ã€ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã§ ã°ã‚“ã”ã¯ã‚“ã‚’ ãŸã¹ã¾ã—ãŸã€‚ã¨ã‚‚ã ã¡ã¨ ãŸãã•ã‚“ ã¯ãªã—ã¾ã—ãŸã€‚ãŸã®ã—ã„ ã—ã‚…ã†ã¾ã¤ã§ã—ãŸã€‚`,
        question: "ãªã«ã‚’ ã¿ã¾ã—ãŸã‹ã€‚",
        options: ["ãƒ†ãƒ¬ãƒ“", "ãˆã„ãŒ", "ã»ã‚“", "ã—ã‚“ã¶ã‚“"],
        correct: 1,
        explanation: "Xem phim (ãˆã„ãŒã‚’ ã¿ã¾ã—ãŸ)"
    },
    {
        passage: `ã—ã‚…ã†ã¾ã¤ã¯ ã¨ã‚‚ã ã¡ã¨ ãˆã„ãŒã‚’ ã¿ã¾ã—ãŸã€‚ãˆã„ãŒã‹ã‚“ã¸ ã„ã£ã¦ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãˆã„ãŒã‚’ ã¿ã¾ã—ãŸã€‚ã¨ã¦ã‚‚ ãŠã‚‚ã—ã‚ã‹ã£ãŸã§ã™ã€‚ãã‚Œã‹ã‚‰ã€ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã§ ã°ã‚“ã”ã¯ã‚“ã‚’ ãŸã¹ã¾ã—ãŸã€‚ã¨ã‚‚ã ã¡ã¨ ãŸãã•ã‚“ ã¯ãªã—ã¾ã—ãŸã€‚ãŸã®ã—ã„ ã—ã‚…ã†ã¾ã¤ã§ã—ãŸã€‚`,
        question: "ã ã‚Œã¨ ãˆã„ãŒã‚’ ã¿ã¾ã—ãŸã‹ã€‚",
        options: ["ã²ã¨ã‚Šã§", "ã‹ããã¨", "ã¨ã‚‚ã ã¡ã¨", "ã›ã‚“ã›ã„ã¨"],
        correct: 2,
        explanation: "Xem vá»›i báº¡n bÃ¨ (ã¨ã‚‚ã ã¡ã¨ ãˆã„ãŒã‚’ ã¿ã¾ã—ãŸ)"
    },
    {
        passage: `ã‘ã• 6ã˜ã« ãŠãã¾ã—ãŸã€‚ã‚·ãƒ£ãƒ¯ãƒ¼ã‚’ ã‚ã³ã¦ã€ã‚ã•ã”ã¯ã‚“ã‚’ ãŸã¹ã¾ã—ãŸã€‚ãã‚Œã‹ã‚‰ã€ãƒã‚¹ã§ ãŒã£ã“ã†ã¸ ã„ãã¾ã—ãŸã€‚ãŒã£ã“ã†ã§ ã«ã»ã‚“ã”ã‚’ ã¹ã‚“ãã‚‡ã†ã—ã¾ã—ãŸã€‚ã”ã”ã€ã¨ã—ã‚‡ã‹ã‚“ã§ ã—ã‚…ãã ã„ã‚’ ã—ã¾ã—ãŸã€‚ã‚ˆã‚‹ã€ã†ã¡ã§ ãƒ†ãƒ¬ãƒ“ã‚’ ã¿ã¾ã—ãŸã€‚`,
        question: "ãªã‚“ã˜ã« ãŠãã¾ã—ãŸã‹ã€‚",
        options: ["5ã˜", "6ã˜", "7ã˜", "8ã˜"],
        correct: 1,
        explanation: "Dáº­y lÃºc 6 giá» (6ã˜ã« ãŠãã¾ã—ãŸ)"
    },
    {
        passage: `ã‘ã• 6ã˜ã« ãŠãã¾ã—ãŸã€‚ã‚·ãƒ£ãƒ¯ãƒ¼ã‚’ ã‚ã³ã¦ã€ã‚ã•ã”ã¯ã‚“ã‚’ ãŸã¹ã¾ã—ãŸã€‚ãã‚Œã‹ã‚‰ã€ãƒã‚¹ã§ ãŒã£ã“ã†ã¸ ã„ãã¾ã—ãŸã€‚ãŒã£ã“ã†ã§ ã«ã»ã‚“ã”ã‚’ ã¹ã‚“ãã‚‡ã†ã—ã¾ã—ãŸã€‚ã”ã”ã€ã¨ã—ã‚‡ã‹ã‚“ã§ ã—ã‚…ãã ã„ã‚’ ã—ã¾ã—ãŸã€‚ã‚ˆã‚‹ã€ã†ã¡ã§ ãƒ†ãƒ¬ãƒ“ã‚’ ã¿ã¾ã—ãŸã€‚`,
        question: "ã©ã†ã‚„ã£ã¦ ãŒã£ã“ã†ã¸ ã„ãã¾ã—ãŸã‹ã€‚",
        options: ["ã‚ã‚‹ã„ã¦", "ãƒã‚¹ã§", "ã§ã‚“ã—ã‚ƒã§", "ã˜ã¦ã‚“ã—ã‚ƒã§"],
        correct: 1,
        explanation: "Äi báº±ng xe buÃ½t (ãƒã‚¹ã§ ãŒã£ã“ã†ã¸ ã„ãã¾ã—ãŸ)"
    },
    {
        passage: `ã‚ãŸã—ã¯ ã‚Šã‚‡ã†ã‚ŠãŒ ã§ãã¾ã™ã€‚ã¾ã„ã«ã¡ ã˜ã¶ã‚“ã§ ã‚Šã‚‡ã†ã‚Šã‚’ ã¤ãã‚Šã¾ã™ã€‚ãƒ™ãƒˆãƒŠãƒ ã‚Šã‚‡ã†ã‚ŠãŒ ã¨ãã„ã§ã™ã€‚ã¨ãã©ã ã¨ã‚‚ã ã¡ã« ã‚Šã‚‡ã†ã‚Šã‚’ ã¤ãã£ã¦ ã‚ã’ã¾ã™ã€‚ã¨ã‚‚ã ã¡ã¯ã€ŒãŠã„ã—ã„ã€ã¨ ã„ã„ã¾ã™ã€‚ã†ã‚Œã—ã„ã§ã™ã€‚`,
        question: "ãªã«ãŒ ã§ãã¾ã™ã‹ã€‚",
        options: ["ã†ãŸ", "ãƒ€ãƒ³ã‚¹", "ã‚Šã‚‡ã†ã‚Š", "ã‚¹ãƒãƒ¼ãƒ„"],
        correct: 2,
        explanation: "CÃ³ thá»ƒ náº¥u Äƒn (ã‚Šã‚‡ã†ã‚ŠãŒ ã§ãã¾ã™)"
    },
    {
        passage: `ã‚ãŸã—ã¯ ã‚Šã‚‡ã†ã‚ŠãŒ ã§ãã¾ã™ã€‚ã¾ã„ã«ã¡ ã˜ã¶ã‚“ã§ ã‚Šã‚‡ã†ã‚Šã‚’ ã¤ãã‚Šã¾ã™ã€‚ãƒ™ãƒˆãƒŠãƒ ã‚Šã‚‡ã†ã‚ŠãŒ ã¨ãã„ã§ã™ã€‚ã¨ãã©ã ã¨ã‚‚ã ã¡ã« ã‚Šã‚‡ã†ã‚Šã‚’ ã¤ãã£ã¦ ã‚ã’ã¾ã™ã€‚ã¨ã‚‚ã ã¡ã¯ã€ŒãŠã„ã—ã„ã€ã¨ ã„ã„ã¾ã™ã€‚ã†ã‚Œã—ã„ã§ã™ã€‚`,
        question: "ã©ã‚“ãª ã‚Šã‚‡ã†ã‚ŠãŒ ã¨ãã„ã§ã™ã‹ã€‚",
        options: ["ã«ã»ã‚“ã‚Šã‚‡ã†ã‚Š", "ãƒ™ãƒˆãƒŠãƒ ã‚Šã‚‡ã†ã‚Š", "ã‹ã‚“ã“ãã‚Šã‚‡ã†ã‚Š", "ã¡ã‚…ã†ã‹ã‚Šã‚‡ã†ã‚Š"],
        correct: 1,
        explanation: "Giá»i mÃ³n Viá»‡t (ãƒ™ãƒˆãƒŠãƒ ã‚Šã‚‡ã†ã‚ŠãŒ ã¨ãã„ã§ã™)"
    },
    {
        passage: `ã«ã¡ã‚ˆã†ã³ã« ã†ã¿ã¸ ã„ãã¾ã—ãŸã€‚ã¨ã‚‚ã ã¡ã¨ ãŠã‚ˆãã¾ã—ãŸã€‚ã™ãªã¯ã¾ã§ ã‚ãã³ã¾ã—ãŸã€‚ãã‚Œã„ãª ã‹ã„ãŒã‚‰ã‚’ ã²ã‚ã„ã¾ã—ãŸã€‚ãã‚Œã‹ã‚‰ã€ã†ã¿ã® ã¡ã‹ãã® ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã§ ã•ã‹ãªã‚’ ãŸã¹ã¾ã—ãŸã€‚ã¨ã¦ã‚‚ ãŠã„ã—ã‹ã£ãŸã§ã™ã€‚ãŸã®ã—ã‹ã£ãŸã§ã™ã€‚`,
        question: "ã©ã“ã¸ ã„ãã¾ã—ãŸã‹ã€‚",
        options: ["ã‚„ã¾", "ã†ã¿", "ã“ã†ãˆã‚“", "ã‹ã‚"],
        correct: 1,
        explanation: "Äi biá»ƒn (ã†ã¿ã¸ ã„ãã¾ã—ãŸ)"
    },
    {
        passage: `ã«ã¡ã‚ˆã†ã³ã« ã†ã¿ã¸ ã„ãã¾ã—ãŸã€‚ã¨ã‚‚ã ã¡ã¨ ãŠã‚ˆãã¾ã—ãŸã€‚ã™ãªã¯ã¾ã§ ã‚ãã³ã¾ã—ãŸã€‚ãã‚Œã„ãª ã‹ã„ãŒã‚‰ã‚’ ã²ã‚ã„ã¾ã—ãŸã€‚ãã‚Œã‹ã‚‰ã€ã†ã¿ã® ã¡ã‹ãã® ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã§ ã•ã‹ãªã‚’ ãŸã¹ã¾ã—ãŸã€‚ã¨ã¦ã‚‚ ãŠã„ã—ã‹ã£ãŸã§ã™ã€‚ãŸã®ã—ã‹ã£ãŸã§ã™ã€‚`,
        question: "ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã§ ãªã«ã‚’ ãŸã¹ã¾ã—ãŸã‹ã€‚",
        options: ["ã«ã", "ã•ã‹ãª", "ã‚„ã•ã„", "ãã ã‚‚ã®"],
        correct: 1,
        explanation: "Ä‚n cÃ¡ (ã•ã‹ãªã‚’ ãŸã¹ã¾ã—ãŸ)"
    },
    {
        passage: `ã‚ãŸã—ã¯ ã‚ˆã ã»ã‚“ã‚’ ã‚ˆã¿ã¾ã™ã€‚1ã—ã‚…ã†ã‹ã‚“ã« 2ã‹ã„ ãã‚‰ã„ ã¨ã—ã‚‡ã‹ã‚“ã¸ ã„ãã¾ã™ã€‚ã™ã„ã‚ˆã†ã³ã¨ ã©ã‚ˆã†ã³ã« ã„ãã¾ã™ã€‚ã¨ã—ã‚‡ã‹ã‚“ã¯ ã—ãšã‹ã§ã€ã¹ã‚“ãã‚‡ã†ã—ã‚„ã™ã„ã§ã™ã€‚ã—ã‚‡ã†ã›ã¤ã‚„ ã¾ã‚“ãŒã‚’ ã‚ˆã¿ã¾ã™ã€‚ã»ã‚“ã‚’ ã‚ˆã‚€ã“ã¨ãŒ ã ã„ã™ãã§ã™ã€‚`,
        question: "1ã—ã‚…ã†ã‹ã‚“ã« ãªã‚“ã‹ã„ ã¨ã—ã‚‡ã‹ã‚“ã¸ ã„ãã¾ã™ã‹ã€‚",
        options: ["1ã‹ã„", "2ã‹ã„", "3ã‹ã„", "ã¾ã„ã«ã¡"],
        correct: 1,
        explanation: "Äi thÆ° viá»‡n 2 láº§n má»™t tuáº§n (1ã—ã‚…ã†ã‹ã‚“ã« 2ã‹ã„ ãã‚‰ã„)"
    },
    {
        passage: `ã‚ãŸã—ã¯ ã‚ˆã ã»ã‚“ã‚’ ã‚ˆã¿ã¾ã™ã€‚1ã—ã‚…ã†ã‹ã‚“ã« 2ã‹ã„ ãã‚‰ã„ ã¨ã—ã‚‡ã‹ã‚“ã¸ ã„ãã¾ã™ã€‚ã™ã„ã‚ˆã†ã³ã¨ ã©ã‚ˆã†ã³ã« ã„ãã¾ã™ã€‚ã¨ã—ã‚‡ã‹ã‚“ã¯ ã—ãšã‹ã§ã€ã¹ã‚“ãã‚‡ã†ã—ã‚„ã™ã„ã§ã™ã€‚ã—ã‚‡ã†ã›ã¤ã‚„ ã¾ã‚“ãŒã‚’ ã‚ˆã¿ã¾ã™ã€‚ã»ã‚“ã‚’ ã‚ˆã‚€ã“ã¨ãŒ ã ã„ã™ãã§ã™ã€‚`,
        question: "ã©ã‚“ãª ã»ã‚“ã‚’ ã‚ˆã¿ã¾ã™ã‹ã€‚",
        options: ["ã–ã£ã—ã ã‘", "ã—ã‚“ã¶ã‚“ã ã‘", "ã—ã‚‡ã†ã›ã¤ã‚„ ã¾ã‚“ãŒ", "ãã‚‡ã†ã‹ã—ã‚‡ã ã‘"],
        correct: 2,
        explanation: "Äá»c tiá»ƒu thuyáº¿t vÃ  manga (ã—ã‚‡ã†ã›ã¤ã‚„ ã¾ã‚“ãŒã‚’ ã‚ˆã¿ã¾ã™)"
    },

    // BÃ i 10 - 10 cÃ¢u
    {
        passage: `ãˆãã® ã¡ã‹ãã« ã‚ãŸã‚‰ã—ã„ ã‚«ãƒ•ã‚§ãŒ ã§ãã¾ã—ãŸã€‚ãã‚Œã„ã§ã€ãŠãŠãã„ ã‚«ãƒ•ã‚§ã§ã™ã€‚ã¾ã  ã„ã£ã¦ ã„ã¾ã›ã‚“ã€‚ã“ã‚“ã© ã¨ã‚‚ã ã¡ã¨ ã„ããŸã„ã§ã™ã€‚ã‚«ãƒ•ã‚§ã‹ã‚‰ ã‚„ã¾ãŒ ã¿ãˆã¾ã™ã€‚ã‚³ãƒ¼ãƒ’ãƒ¼ãŒ ãŠã„ã—ã„ãã†ã§ã™ã€‚`,
        question: "ã‚«ãƒ•ã‚§ã¯ ã©ã“ã« ã‚ã‚Šã¾ã™ã‹ã€‚",
        options: ["ãŒã£ã“ã†ã® ã¡ã‹ã", "ãˆãã® ã¡ã‹ã", "ã†ã¡ã® ã¡ã‹ã", "ã“ã†ãˆã‚“ã® ã¡ã‹ã"],
        correct: 1,
        explanation: "QuÃ¡n cÃ  phÃª á»Ÿ gáº§n ga (ãˆãã® ã¡ã‹ãã«)"
    },
    {
        passage: `ãˆãã® ã¡ã‹ãã« ã‚ãŸã‚‰ã—ã„ ã‚«ãƒ•ã‚§ãŒ ã§ãã¾ã—ãŸã€‚ãã‚Œã„ã§ã€ãŠãŠãã„ ã‚«ãƒ•ã‚§ã§ã™ã€‚ã¾ã  ã„ã£ã¦ ã„ã¾ã›ã‚“ã€‚ã“ã‚“ã© ã¨ã‚‚ã ã¡ã¨ ã„ããŸã„ã§ã™ã€‚ã‚«ãƒ•ã‚§ã‹ã‚‰ ã‚„ã¾ãŒ ã¿ãˆã¾ã™ã€‚ã‚³ãƒ¼ãƒ’ãƒ¼ãŒ ãŠã„ã—ã„ãã†ã§ã™ã€‚`,
        question: "ã‚‚ã† ã‚«ãƒ•ã‚§ã¸ ã„ãã¾ã—ãŸã‹ã€‚",
        options: ["ã¯ã„ã€ã„ãã¾ã—ãŸ", "ã„ã„ãˆã€ã¾ã ã§ã™", "ã‚ˆã ã„ãã¾ã™", "ãã®ã† ã„ãã¾ã—ãŸ"],
        correct: 1,
        explanation: "ChÆ°a Ä‘i (ã¾ã  ã„ã£ã¦ ã„ã¾ã›ã‚“)"
    },
    {
        passage: `ã‚ã—ãŸ ãƒ†ã‚¹ãƒˆãŒ ã‚ã‚Šã¾ã™ã€‚ã ã‹ã‚‰ã€ãã‚‡ã†ã¯ ã„ãˆã§ ã¹ã‚“ãã‚‡ã†ã—ã¾ã™ã€‚ã¨ã—ã‚‡ã‹ã‚“ã¸ ã„ã‹ãªã„ã§ã€ã†ã¡ã§ ã¹ã‚“ãã‚‡ã†ã—ã¾ã™ã€‚ãƒ†ãƒ¬ãƒ“ã‚’ ã¿ãªã„ã§ã€ã¹ã‚“ãã‚‡ã†ã—ã¾ã™ã€‚ã¨ã‚‚ã ã¡ã¨ ã‚ãã°ãªã„ã§ã€ã¹ã‚“ãã‚‡ã†ã—ã¾ã™ã€‚ãŒã‚“ã°ã‚Šã¾ã™ã€‚`,
        question: "ã‚ã—ãŸ ãªã«ãŒ ã‚ã‚Šã¾ã™ã‹ã€‚",
        options: ["ã—ã‘ã‚“", "ãƒ†ã‚¹ãƒˆ", "ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼", "ã‚Šã‚‡ã“ã†"],
        correct: 1,
        explanation: "NgÃ y mai cÃ³ bÃ i kiá»ƒm tra (ã‚ã—ãŸ ãƒ†ã‚¹ãƒˆãŒ ã‚ã‚Šã¾ã™)"
    },
    {
        passage: `ã‚ã—ãŸ ãƒ†ã‚¹ãƒˆãŒ ã‚ã‚Šã¾ã™ã€‚ã ã‹ã‚‰ã€ãã‚‡ã†ã¯ ã„ãˆã§ ã¹ã‚“ãã‚‡ã†ã—ã¾ã™ã€‚ã¨ã—ã‚‡ã‹ã‚“ã¸ ã„ã‹ãªã„ã§ã€ã†ã¡ã§ ã¹ã‚“ãã‚‡ã†ã—ã¾ã™ã€‚ãƒ†ãƒ¬ãƒ“ã‚’ ã¿ãªã„ã§ã€ã¹ã‚“ãã‚‡ã†ã—ã¾ã™ã€‚ã¨ã‚‚ã ã¡ã¨ ã‚ãã°ãªã„ã§ã€ã¹ã‚“ãã‚‡ã†ã—ã¾ã™ã€‚ãŒã‚“ã°ã‚Šã¾ã™ã€‚`,
        question: "ãã‚‡ã† ã©ã“ã§ ã¹ã‚“ãã‚‡ã†ã—ã¾ã™ã‹ã€‚",
        options: ["ã¨ã—ã‚‡ã‹ã‚“", "ãŒã£ã“ã†", "ã„ãˆ", "ã‚«ãƒ•ã‚§"],
        correct: 2,
        explanation: "Há»c á»Ÿ nhÃ  (ã„ãˆã§ ã¹ã‚“ãã‚‡ã†ã—ã¾ã™)"
    },
    {
        passage: `ã‚³ãƒ³ãƒ“ãƒ‹ã¸ ã„ã£ã¦ ãã¾ã™ã€‚ã‚¸ãƒ¥ãƒ¼ã‚¹ã¨ ãŠã‹ã—ã‚’ ã‹ã£ã¦ ãã¾ã™ã€‚10ã·ã‚“ ãã‚‰ã„ã§ ã‹ãˆã£ã¦ ãã¾ã™ã€‚ã§ã‚“ã‚ãŒ ã‚ã£ãŸã‚‰ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ ãŠã„ã¦ ãã ã•ã„ã€‚`,
        question: "ã©ã“ã¸ ã„ãã¾ã™ã‹ã€‚",
        options: ["ã‚¹ãƒ¼ãƒ‘ãƒ¼", "ã‚³ãƒ³ãƒ“ãƒ‹", "ãƒ‡ãƒ‘ãƒ¼ãƒˆ", "ã»ã‚“ã‚„"],
        correct: 1,
        explanation: "Äi cá»­a hÃ ng tiá»‡n lá»£i (ã‚³ãƒ³ãƒ“ãƒ‹ã¸ ã„ã£ã¦ ãã¾ã™)"
    },
    {
        passage: `ã‚³ãƒ³ãƒ“ãƒ‹ã¸ ã„ã£ã¦ ãã¾ã™ã€‚ã‚¸ãƒ¥ãƒ¼ã‚¹ã¨ ãŠã‹ã—ã‚’ ã‹ã£ã¦ ãã¾ã™ã€‚10ã·ã‚“ ãã‚‰ã„ã§ ã‹ãˆã£ã¦ ãã¾ã™ã€‚ã§ã‚“ã‚ãŒ ã‚ã£ãŸã‚‰ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ ãŠã„ã¦ ãã ã•ã„ã€‚`,
        question: "ãªã«ã‚’ ã‹ã„ã¾ã™ã‹ã€‚",
        options: ["ã»ã‚“ã¨ ã–ã£ã—", "ã‚¸ãƒ¥ãƒ¼ã‚¹ã¨ ãŠã‹ã—", "ãã¤ã¨ ã‹ã°ã‚“", "ã•ã‹ãªã¨ ã‚„ã•ã„"],
        correct: 1,
        explanation: "Mua nÆ°á»›c ngá»t vÃ  káº¹o (ã‚¸ãƒ¥ãƒ¼ã‚¹ã¨ ãŠã‹ã—ã‚’ ã‹ã£ã¦ ãã¾ã™)"
    },
    {
        passage: `ã³ã˜ã‚…ã¤ã‹ã‚“ã§ ãˆã‚’ ã¿ã¦ ã„ã¾ã™ã€‚ã‚†ã†ã‚ã„ãª ãŒã‹ã® ãˆã§ã™ã€‚ã¨ã¦ã‚‚ ãã‚Œã„ã§ã™ã€‚ã—ã‚ƒã—ã‚“ã‚’ ã¨ã£ã¦ã‚‚ ã„ã„ã§ã™ã‹ã€‚ã„ã„ãˆã€ã¨ã‚‰ãªã„ã§ ãã ã•ã„ã€‚ã³ã˜ã‚…ã¤ã‹ã‚“ã® ãªã‹ã§ ã—ã‚ƒã—ã‚“ã‚’ ã¨ã‚‹ã“ã¨ãŒ ã§ãã¾ã›ã‚“ã€‚`,
        question: "ã©ã“ã« ã„ã¾ã™ã‹ã€‚",
        options: ["ã¨ã—ã‚‡ã‹ã‚“", "ã³ã˜ã‚…ã¤ã‹ã‚“", "ã“ã†ãˆã‚“", "ãŒã£ã“ã†"],
        correct: 1,
        explanation: "Äang á»Ÿ viá»‡n báº£o tÃ ng má»¹ thuáº­t (ã³ã˜ã‚…ã¤ã‹ã‚“ã§)"
    },
    {
        passage: `ã³ã˜ã‚…ã¤ã‹ã‚“ã§ ãˆã‚’ ã¿ã¦ ã„ã¾ã™ã€‚ã‚†ã†ã‚ã„ãª ãŒã‹ã® ãˆã§ã™ã€‚ã¨ã¦ã‚‚ ãã‚Œã„ã§ã™ã€‚ã—ã‚ƒã—ã‚“ã‚’ ã¨ã£ã¦ã‚‚ ã„ã„ã§ã™ã‹ã€‚ã„ã„ãˆã€ã¨ã‚‰ãªã„ã§ ãã ã•ã„ã€‚ã³ã˜ã‚…ã¤ã‹ã‚“ã® ãªã‹ã§ ã—ã‚ƒã—ã‚“ã‚’ ã¨ã‚‹ã“ã¨ãŒ ã§ãã¾ã›ã‚“ã€‚`,
        question: "ã³ã˜ã‚…ã¤ã‹ã‚“ã§ ã—ã‚ƒã—ã‚“ã‚’ ã¨ã‚‹ã“ã¨ãŒ ã§ãã¾ã™ã‹ã€‚",
        options: ["ã¯ã„ã€ã§ãã¾ã™", "ã„ã„ãˆã€ã§ãã¾ã›ã‚“", "ã¨ãã©ã ã§ãã¾ã™", "ã‚ã‹ã‚Šã¾ã›ã‚“"],
        correct: 1,
        explanation: "KhÃ´ng thá»ƒ chá»¥p áº£nh (ã¨ã‚‹ã“ã¨ãŒ ã§ãã¾ã›ã‚“)"
    },
    {
        passage: `ã«ã»ã‚“ã”ã® ã‚¯ãƒ©ã‚¹ã¯ 9ã˜ã« ã¯ã˜ã¾ã‚Šã¾ã™ã€‚ã¾ãˆã« ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’ ã®ã‚“ã§ã€ã—ã‚“ã¶ã‚“ã‚’ ã‚ˆã¿ã¾ã™ã€‚8ã˜ã« ãã‚‡ã†ã—ã¤ã« ã¤ãã¾ã™ã€‚ã¨ã‚‚ã ã¡ã¨ ã¯ãªã—ã¦ã€ã˜ã‚…ãã‚‡ã†ã® ã˜ã‚…ã‚“ã³ã‚’ ã—ã¾ã™ã€‚ã›ã‚“ã›ã„ãŒ ãã¦ã€ã˜ã‚…ãã‚‡ã†ãŒ ã¯ã˜ã¾ã‚Šã¾ã™ã€‚`,
        question: "ãªã‚“ã˜ã« ã‚¯ãƒ©ã‚¹ãŒ ã¯ã˜ã¾ã‚Šã¾ã™ã‹ã€‚",
        options: ["8ã˜", "9ã˜", "10ã˜", "11ã˜"],
        correct: 1,
        explanation: "Lá»›p báº¯t Ä‘áº§u lÃºc 9 giá» (9ã˜ã« ã¯ã˜ã¾ã‚Šã¾ã™)"
    },
    {
        passage: `ã«ã»ã‚“ã”ã® ã‚¯ãƒ©ã‚¹ã¯ 9ã˜ã« ã¯ã˜ã¾ã‚Šã¾ã™ã€‚ã¾ãˆã« ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’ ã®ã‚“ã§ã€ã—ã‚“ã¶ã‚“ã‚’ ã‚ˆã¿ã¾ã™ã€‚8ã˜ã« ãã‚‡ã†ã—ã¤ã« ã¤ãã¾ã™ã€‚ã¨ã‚‚ã ã¡ã¨ ã¯ãªã—ã¦ã€ã˜ã‚…ãã‚‡ã†ã® ã˜ã‚…ã‚“ã³ã‚’ ã—ã¾ã™ã€‚ã›ã‚“ã›ã„ãŒ ãã¦ã€ã˜ã‚…ãã‚‡ã†ãŒ ã¯ã˜ã¾ã‚Šã¾ã™ã€‚`,
        question: "ã‚¯ãƒ©ã‚¹ã® ã¾ãˆã« ãªã«ã‚’ ã—ã¾ã™ã‹ã€‚",
        options: ["ã­ã¾ã™", "ã¹ã‚“ãã‚‡ã†ã—ã¾ã™", "ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’ ã®ã¿ã¾ã™", "ã‚Šã‚‡ã†ã‚Šã‚’ ã¤ãã‚Šã¾ã™"],
        correct: 2,
        explanation: "Uá»‘ng cÃ  phÃª trÆ°á»›c lá»›p (ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’ ã®ã‚“ã§)"
    },

    // BÃ i 11 - 10 cÃ¢u
    {
        passage: `ã‚ãŸã—ã¯ ã«ã»ã‚“ã”ãŒ ã™ãã§ã™ã€‚ã§ã‚‚ã€ã‹ã‚“ã˜ã¯ ã‚€ãšã‹ã—ã„ã§ã™ã€‚ã¾ã„ã«ã¡ ã‹ã‚“ã˜ã‚’ ã¹ã‚“ãã‚‡ã†ã—ã¦ ã„ã¾ã™ã€‚ãƒãƒ¼ãƒˆã« ãªã‚“ã©ã‚‚ ã‹ãã¾ã™ã€‚ã‹ã‚“ã˜ã® ãƒ†ã‚¹ãƒˆã¯ ã‚€ãšã‹ã—ã„ã§ã™ãŒã€ãŒã‚“ã°ã‚Šã¾ã™ã€‚ã›ã‚“ã›ã„ã¯ ã‚„ã•ã—ã„ã§ã™ã€‚`,
        question: "ãªã«ãŒ ã‚€ãšã‹ã—ã„ã§ã™ã‹ã€‚",
        options: ["ã¶ã‚“ã½ã†", "ãŸã‚“ã”", "ã‹ã‚“ã˜", "ã‹ã„ã‚"],
        correct: 2,
        explanation: "Kanji khÃ³ (ã‹ã‚“ã˜ã¯ ã‚€ãšã‹ã—ã„ã§ã™)"
    },
    {
        passage: `ã‚ãŸã—ã¯ ã«ã»ã‚“ã”ãŒ ã™ãã§ã™ã€‚ã§ã‚‚ã€ã‹ã‚“ã˜ã¯ ã‚€ãšã‹ã—ã„ã§ã™ã€‚ã¾ã„ã«ã¡ ã‹ã‚“ã˜ã‚’ ã¹ã‚“ãã‚‡ã†ã—ã¦ ã„ã¾ã™ã€‚ãƒãƒ¼ãƒˆã« ãªã‚“ã©ã‚‚ ã‹ãã¾ã™ã€‚ã‹ã‚“ã˜ã® ãƒ†ã‚¹ãƒˆã¯ ã‚€ãšã‹ã—ã„ã§ã™ãŒã€ãŒã‚“ã°ã‚Šã¾ã™ã€‚ã›ã‚“ã›ã„ã¯ ã‚„ã•ã—ã„ã§ã™ã€‚`,
        question: "ã©ã†ã‚„ã£ã¦ ã‹ã‚“ã˜ã‚’ ã¹ã‚“ãã‚‡ã†ã—ã¾ã™ã‹ã€‚",
        options: ["ã‚ˆã‚€ã ã‘", "ããã ã‘", "ãƒãƒ¼ãƒˆã« ã‹ãã¾ã™", "ãªã«ã‚‚ ã—ã¾ã›ã‚“"],
        correct: 2,
        explanation: "Viáº¿t vÃ o vá»Ÿ (ãƒãƒ¼ãƒˆã« ãªã‚“ã©ã‚‚ ã‹ãã¾ã™)"
    },
    {
        passage: `ã‚„ã™ã¿ã® ã²ã¯ ã„ã‚ã„ã‚ãª ã“ã¨ã‚’ ã—ã¾ã™ã€‚ã‚ã• ãŠãã¦ã€ã‚¸ãƒ§ã‚®ãƒ³ã‚°ã‚’ ã—ãŸã‚Šã€ãƒ¨ã‚¬ã‚’ ã—ãŸã‚Š ã—ã¾ã™ã€‚ã²ã‚‹ã”ã¯ã‚“ã® ã‚ã¨ã§ã€ã»ã‚“ã‚’ ã‚ˆã‚“ã ã‚Šã€ãŠã‚“ãŒãã‚’ ãã„ãŸã‚Š ã—ã¾ã™ã€‚ã‚ˆã‚‹ã€ã¨ã‚‚ã ã¡ã¨ ã§ã‚“ã‚ã§ ã¯ãªã—ã¾ã™ã€‚`,
        question: "ã‚ã• ãªã«ã‚’ ã—ã¾ã™ã‹ã€‚",
        options: ["ã­ã¾ã™", "ã¹ã‚“ãã‚‡ã†ã—ã¾ã™", "ã‚¸ãƒ§ã‚®ãƒ³ã‚°ã‚„ ãƒ¨ã‚¬ã‚’ ã—ã¾ã™", "ã‚Šã‚‡ã†ã‚Šã‚’ ã¤ãã‚Šã¾ã™"],
        correct: 2,
        explanation: "Cháº¡y bá»™ vÃ  yoga (ã‚¸ãƒ§ã‚®ãƒ³ã‚°ã‚’ ã—ãŸã‚Šã€ãƒ¨ã‚¬ã‚’ ã—ãŸã‚Š ã—ã¾ã™)"
    },
    {
        passage: `ã‚„ã™ã¿ã® ã²ã¯ ã„ã‚ã„ã‚ãª ã“ã¨ã‚’ ã—ã¾ã™ã€‚ã‚ã• ãŠãã¦ã€ã‚¸ãƒ§ã‚®ãƒ³ã‚°ã‚’ ã—ãŸã‚Šã€ãƒ¨ã‚¬ã‚’ ã—ãŸã‚Š ã—ã¾ã™ã€‚ã²ã‚‹ã”ã¯ã‚“ã® ã‚ã¨ã§ã€ã»ã‚“ã‚’ ã‚ˆã‚“ã ã‚Šã€ãŠã‚“ãŒãã‚’ ãã„ãŸã‚Š ã—ã¾ã™ã€‚ã‚ˆã‚‹ã€ã¨ã‚‚ã ã¡ã¨ ã§ã‚“ã‚ã§ ã¯ãªã—ã¾ã™ã€‚`,
        question: "ã²ã‚‹ã”ã¯ã‚“ã® ã‚ã¨ã§ ãªã«ã‚’ ã—ã¾ã™ã‹ã€‚",
        options: ["ã­ã¾ã™", "ã»ã‚“ã‚’ ã‚ˆã‚“ã ã‚Š ãŠã‚“ãŒãã‚’ ãã„ãŸã‚Š ã—ã¾ã™", "ã•ã‚“ã½ã—ã¾ã™", "ãƒ†ãƒ¬ãƒ“ã‚’ ã¿ã¾ã™"],
        correct: 1,
        explanation: "Äá»c sÃ¡ch vÃ  nghe nháº¡c (ã»ã‚“ã‚’ ã‚ˆã‚“ã ã‚Šã€ãŠã‚“ãŒãã‚’ ãã„ãŸã‚Š ã—ã¾ã™)"
    },
    {
        passage: `ã•ã‚€ã„ ã¨ãã€ã‚ãŸãŸã‹ã„ ãŠã¡ã‚ƒã‚’ ã®ã¿ã¾ã™ã€‚ã‚ã¤ã„ ã¨ãã€ã¤ã‚ãŸã„ ã‚¸ãƒ¥ãƒ¼ã‚¹ã‚’ ã®ã¿ã¾ã™ã€‚ã¤ã‹ã‚ŒãŸ ã¨ãã€ãŠã‚“ãŒãã‚’ ããã¾ã™ã€‚ã²ã¾ãª ã¨ãã€ã•ã‚“ã½ã—ã¾ã™ã€‚ã„ããŒã—ã„ ã¨ãã‚‚ã€ã†ã‚“ã©ã†ã—ã¾ã™ã€‚`,
        question: "ã•ã‚€ã„ ã¨ãã€ãªã«ã‚’ ã®ã¿ã¾ã™ã‹ã€‚",
        options: ["ã¤ã‚ãŸã„ ã‚¸ãƒ¥ãƒ¼ã‚¹", "ã‚ãŸãŸã‹ã„ ãŠã¡ã‚ƒ", "ãƒ“ãƒ¼ãƒ«", "ã¿ãš"],
        correct: 1,
        explanation: "Uá»‘ng trÃ  áº¥m (ã‚ãŸãŸã‹ã„ ãŠã¡ã‚ƒã‚’ ã®ã¿ã¾ã™)"
    },
    {
        passage: `ã•ã‚€ã„ ã¨ãã€ã‚ãŸãŸã‹ã„ ãŠã¡ã‚ƒã‚’ ã®ã¿ã¾ã™ã€‚ã‚ã¤ã„ ã¨ãã€ã¤ã‚ãŸã„ ã‚¸ãƒ¥ãƒ¼ã‚¹ã‚’ ã®ã¿ã¾ã™ã€‚ã¤ã‹ã‚ŒãŸ ã¨ãã€ãŠã‚“ãŒãã‚’ ããã¾ã™ã€‚ã²ã¾ãª ã¨ãã€ã•ã‚“ã½ã—ã¾ã™ã€‚ã„ããŒã—ã„ ã¨ãã‚‚ã€ã†ã‚“ã©ã†ã—ã¾ã™ã€‚`,
        question: "ã¤ã‹ã‚ŒãŸ ã¨ãã€ãªã«ã‚’ ã—ã¾ã™ã‹ã€‚",
        options: ["ã­ã¾ã™", "ãŠã‚“ãŒãã‚’ ããã¾ã™", "ã¹ã‚“ãã‚‡ã†ã—ã¾ã™", "ã‚Šã‚‡ã†ã‚Šã—ã¾ã™"],
        correct: 1,
        explanation: "Nghe nháº¡c (ãŠã‚“ãŒãã‚’ ããã¾ã™)"
    },
    {
        passage: `ã‚‰ã„ã—ã‚…ã† ãƒ†ã‚¹ãƒˆãŒ ã‚ã‚Šã¾ã™ã€‚ã©ã†ã—ã¾ã™ã‹ã€‚ã¾ãšã€ãã‚‡ã†ã‹ã—ã‚‡ã‚’ ã‚ˆã¿ã¾ã™ã€‚ãã‚Œã‹ã‚‰ã€ã‚‚ã‚“ã ã„ã—ã‚…ã†ã‚’ ã—ã¾ã™ã€‚ã‚ã‹ã‚‰ãªã„ ã“ã¨ãŒ ã‚ã£ãŸã‚‰ã€ã›ã‚“ã›ã„ã« ããã¾ã™ã€‚ãƒ†ã‚¹ãƒˆã® ã¾ãˆã® ã²ã¯ã€ã¯ã‚„ã ã­ã¾ã™ã€‚`,
        question: "ãƒ†ã‚¹ãƒˆã¯ ã„ã¤ ã‚ã‚Šã¾ã™ã‹ã€‚",
        options: ["ãã‚‡ã†", "ã‚ã—ãŸ", "ã‚‰ã„ã—ã‚…ã†", "ã‚‰ã„ã’ã¤"],
        correct: 2,
        explanation: "Tuáº§n sau cÃ³ kiá»ƒm tra (ã‚‰ã„ã—ã‚…ã† ãƒ†ã‚¹ãƒˆãŒ ã‚ã‚Šã¾ã™)"
    },
    {
        passage: `ã‚‰ã„ã—ã‚…ã† ãƒ†ã‚¹ãƒˆãŒ ã‚ã‚Šã¾ã™ã€‚ã©ã†ã—ã¾ã™ã‹ã€‚ã¾ãšã€ãã‚‡ã†ã‹ã—ã‚‡ã‚’ ã‚ˆã¿ã¾ã™ã€‚ãã‚Œã‹ã‚‰ã€ã‚‚ã‚“ã ã„ã—ã‚…ã†ã‚’ ã—ã¾ã™ã€‚ã‚ã‹ã‚‰ãªã„ ã“ã¨ãŒ ã‚ã£ãŸã‚‰ã€ã›ã‚“ã›ã„ã« ããã¾ã™ã€‚ãƒ†ã‚¹ãƒˆã® ã¾ãˆã® ã²ã¯ã€ã¯ã‚„ã ã­ã¾ã™ã€‚`,
        question: "ã‚ã‹ã‚‰ãªã„ ã¨ãã€ã©ã†ã—ã¾ã™ã‹ã€‚",
        options: ["ãªã«ã‚‚ ã—ã¾ã›ã‚“", "ã¨ã‚‚ã ã¡ã« ããã¾ã™", "ã›ã‚“ã›ã„ã« ããã¾ã™", "ã‚ãã‚‰ã‚ã¾ã™"],
        correct: 2,
        explanation: "Há»i giÃ¡o viÃªn (ã›ã‚“ã›ã„ã« ããã¾ã™)"
    },
    {
        passage: `ã‚ãŸã—ã¯ ã¾ã„ã‚ã• 6ã˜ã« ãŠãã¾ã™ã€‚ã‚ã«ã¯ 7ã˜ã« ãŠãã¾ã™ã€‚ã¡ã¡ã¯ 5ã˜ã« ãŠãã¾ã™ã€‚ã¯ã¯ã¯ 6ã˜ã¯ã‚“ã« ãŠãã¾ã™ã€‚ã¡ã¡ãŒ ã„ã¡ã°ã‚“ ã¯ã‚„ã ãŠãã¾ã™ã€‚ã¡ã¡ã¯ ã¾ã„ã‚ã• ã†ã‚“ã©ã†ã—ã¾ã™ã€‚ã’ã‚“ãã§ã™ã€‚`,
        question: "ã ã‚ŒãŒ ã„ã¡ã°ã‚“ ã¯ã‚„ã ãŠãã¾ã™ã‹ã€‚",
        options: ["ã‚ãŸã—", "ã‚ã«", "ã¡ã¡", "ã¯ã¯"],
        correct: 2,
        explanation: "Bá»‘ dáº­y sá»›m nháº¥t (ã¡ã¡ãŒ ã„ã¡ã°ã‚“ ã¯ã‚„ã ãŠãã¾ã™)"
    },
    {
        passage: `ã‚ãŸã—ã¯ ã¾ã„ã‚ã• 6ã˜ã« ãŠãã¾ã™ã€‚ã‚ã«ã¯ 7ã˜ã« ãŠãã¾ã™ã€‚ã¡ã¡ã¯ 5ã˜ã« ãŠãã¾ã™ã€‚ã¯ã¯ã¯ 6ã˜ã¯ã‚“ã« ãŠãã¾ã™ã€‚ã¡ã¡ãŒ ã„ã¡ã°ã‚“ ã¯ã‚„ã ãŠãã¾ã™ã€‚ã¡ã¡ã¯ ã¾ã„ã‚ã• ã†ã‚“ã©ã†ã—ã¾ã™ã€‚ã’ã‚“ãã§ã™ã€‚`,
        question: "ã¡ã¡ã¯ ã¾ã„ã‚ã• ãªã«ã‚’ ã—ã¾ã™ã‹ã€‚",
        options: ["ã­ã¾ã™", "ã¹ã‚“ãã‚‡ã†ã—ã¾ã™", "ã†ã‚“ã©ã†ã—ã¾ã™", "ãƒ†ãƒ¬ãƒ“ã‚’ ã¿ã¾ã™"],
        correct: 2,
        explanation: "Táº­p thá»ƒ dá»¥c (ã†ã‚“ã©ã†ã—ã¾ã™)"
    }
];

function startReadingQuiz() {
    quizData = [...readingQuizData];
    currentQuizIndex = 0;
    quizScore = 0;
    selectedAnswer = null;
    userAnswers = [];
    
    document.querySelector('.grammar-item').style.display = 'none';
    document.getElementById('quizArea').style.display = 'block';
    document.getElementById('quizResult').style.display = 'none';
    
    showQuizQuestion();
}

function showQuizQuestion() {
    const question = quizData[currentQuizIndex];
    
    document.getElementById('currentQuestion').textContent = `CÃ¢u ${currentQuizIndex + 1}/42`;
    document.getElementById('quizScore').textContent = `Äiá»ƒm: ${quizScore}`;
    document.getElementById('progressFill').style.width = `${((currentQuizIndex) / 42) * 100}%`;
    
    document.getElementById('passageText').textContent = question.passage;
    document.getElementById('questionText').textContent = question.question;
    
    const optionsHtml = question.options.map((opt, i) => 
        `<div class="quiz-option" onclick="selectQuizAnswer(${i})">${opt}</div>`
    ).join('');
    
    document.getElementById('quizOptions').innerHTML = optionsHtml;
    document.getElementById('answerFeedback').style.display = 'none';
    document.getElementById('submitAnswer').style.display = 'inline-block';
    document.getElementById('nextQuestion').style.display = 'none';
    
    selectedAnswer = null;
}

function selectQuizAnswer(index) {
    if (selectedAnswer !== null) return;
    
    const options = document.querySelectorAll('.quiz-option');
    options.forEach(opt => opt.classList.remove('selected'));
    options[index].classList.add('selected');
    selectedAnswer = index;
}

function submitQuizAnswer() {
    if (selectedAnswer === null) {
        alert('Vui lÃ²ng chá»n má»™t Ä‘Ã¡p Ã¡n!');
        return;
    }
    
    const question = quizData[currentQuizIndex];
    const options = document.querySelectorAll('.quiz-option');
    const isCorrect = selectedAnswer === question.correct;
    
    if (isCorrect) {
        quizScore++;
        options[selectedAnswer].classList.add('correct');
        document.getElementById('answerFeedback').className = 'answer-feedback correct';
        document.getElementById('answerFeedback').innerHTML = `âœ“ ÄÃºng rá»“i!<br>${question.explanation}`;
    } else {
        options[selectedAnswer].classList.add('incorrect');
        options[question.correct].classList.add('correct');
        document.getElementById('answerFeedback').className = 'answer-feedback incorrect';
        document.getElementById('answerFeedback').innerHTML = `âœ— Sai rá»“i!<br>ÄÃ¡p Ã¡n Ä‘Ãºng: ${question.options[question.correct]}<br>${question.explanation}`;
    }
    
    userAnswers.push({
        question: question.question,
        passage: question.passage,
        userAnswer: question.options[selectedAnswer],
        correctAnswer: question.options[question.correct],
        isCorrect: isCorrect
    });
    
    options.forEach(opt => opt.classList.add('disabled'));
    document.getElementById('answerFeedback').style.display = 'block';
    document.getElementById('submitAnswer').style.display = 'none';
    document.getElementById('nextQuestion').style.display = 'inline-block';
}

function nextQuizQuestion() {
    currentQuizIndex++;
    
    if (currentQuizIndex < quizData.length) {
        showQuizQuestion();
    } else {
        showQuizResult();
    }
}

function showQuizResult() {
    document.getElementById('quizArea').style.display = 'none';
    document.getElementById('quizResult').style.display = 'block';
    
    const percentage = Math.round((quizScore / 42) * 100);
    document.getElementById('finalScore').textContent = `${quizScore}/42`;
    document.getElementById('finalPercentage').textContent = `${percentage}%`;
    
    let detailsHtml = '';
    userAnswers.forEach((ans, i) => {
        detailsHtml += `
            <div class="result-item ${ans.isCorrect ? 'correct' : 'incorrect'}">
                <div class="result-question"><strong>CÃ¢u ${i + 1}:</strong> ${ans.question}</div>
                ${!ans.isCorrect ? `<div class="result-answer your-answer">Báº¡n chá»n: ${ans.userAnswer}</div>` : ''}
                <div class="result-answer correct-answer">ÄÃ¡p Ã¡n Ä‘Ãºng: ${ans.correctAnswer}</div>
            </div>
        `;
    });
    
    document.getElementById('resultDetails').innerHTML = detailsHtml;
}
