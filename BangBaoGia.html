<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bảng Báo Giá</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="bangbaogia.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div class="wrapper">
        <div class="controls">
            <button onclick="addRow()" class="add-btn">Thêm Hàng</button>
            <button onclick="printTable()" class="print-btn">In</button>
            <button onclick="exportToExcel()" class="excel-btn">Xuất Excel</button>
            <button onclick="document.getElementById('excelFileInput').click()" class="load-btn">Load Excel</button>
            <input type="file" id="excelFileInput" accept=".xlsx, .xls" style="display: none;" onchange="loadFromExcel(event)">
            <button onclick="clearTable()" class="delete-btn">Xóa Tất Cả</button>
            <button onclick="window.location.href='index.html'" class="excel-btn" style="background-color: #9C27B0;">Bảng Khối Lượng</button>
            <button onclick="showHelp()" class="help-btn">Cách sử dụng</button>
        </div>
        
        <div class="container">
            <div class="editable-header">
                <input type="text" id="companyName" placeholder="Tên công ty" value="CTY TNHH TRƯỜNG GIANG WINDOWS">
                <input type="text" id="companyTax" placeholder="MST" value="MST:1702262181">
                <input type="text" id="companyAddress" placeholder="Địa chỉ" value="Đ/C: P45, căn 19, khu đô thị Phú Cường, phường An Hoà, TP.Rạch Giá, Kiên Giang">
                <input type="text" id="companyPhone" placeholder="SĐT" value="SĐT: 0919808309">
            </div>

            <div class="header">
                <div class="title">BẢNG BÁO GIÁ</div>
                <div class="subtitle">
                    <span>Kính gửi quý khách hàng: <input type="text" id="customerName" placeholder="Nhập tên" value="" style="border: none; border-bottom: 1px solid #000; padding: 2px 5px; min-width: 150px; background: transparent; font-style: italic; font-size: 16px; font-family: 'Times New Roman', serif;"></span>
                </div>
            </div>

        <table id="priceTable">
            <thead>
                <tr>
                    <th style="width: 60px;">STT</th>
                    <th style="width: 400px;">Tên Hàng</th>
                    <th style="width: 250px;">Đơn Giá</th>
                    <th style="width: 180px;" class="no-print">Thao Tác</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <!-- Rows will be added here -->
            </tbody>
        </table>
        
        <div style="margin-top: 20px; font-size: 14px;">
            <strong>*Chú ý:</strong> <input type="text" id="noteText" placeholder="Nhập lưu ý...">
        </div>
    </div>
    </div>

    <!-- Floating Action Button for Mobile -->
    <button id="fabBtn" class="fab-button" onclick="toggleFabMenu(event)">
        <span class="fab-icon">☰</span>
    </button>
    <div id="fabMenu" class="fab-menu">
        <button onclick="addRow()" class="add-btn">Thêm Hàng</button>
        <button onclick="printTable(); toggleFabMenu()" class="print-btn">In</button>
        <button onclick="exportToPDF(); toggleFabMenu()" class="print-btn" style="background-color: #E91E63;">Xuất PDF</button>
        <button onclick="exportToExcel(); toggleFabMenu()" class="excel-btn">Xuất Excel</button>
        <button onclick="document.getElementById('excelFileInput').click(); toggleFabMenu()" class="load-btn">Load Excel</button>
        <button onclick="clearTable(); toggleFabMenu()" class="delete-btn">Xóa Tất Cả</button>
        <button onclick="window.location.href='index.html'" class="excel-btn" style="background-color: #9C27B0;">Bảng Khối Lượng</button>
        <button onclick="showHelp(); toggleFabMenu()" class="help-btn">Cách sử dụng</button>
    </div>

    <!-- Modal Hướng dẫn -->
    <div id="helpModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeHelp()">&times;</span>
            <h2>Hướng dẫn sử dụng</h2>
            <div class="help-content">
                <h3>1. Nhập thông tin công ty:</h3>
                <p>- Chỉnh sửa tên công ty, MST, địa chỉ, số điện thoại ở phía trên</p>
                <p>- Nhập tên khách hàng vào ô sau "Kính gửi quý khách hàng:"</p>
                
                <h3>2. Thêm hàng hóa:</h3>
                <p>- Nhấn nút "Thêm Hàng" để thêm dòng mới</p>
                <p>- Nhập tên hàng và đơn giá</p>
                
                <h3>3. Đơn giá:</h3>
                <p>- Nhập <strong>1200</strong> → Tự động format thành <strong>1.200.000</strong> khi chuyển ô</p>
                <p>- Nhấn nút <strong>Edit</strong> để chọn đơn vị (/m², /cái, /cây)</p>
                <p>- Ví dụ: Chọn /m² → <strong>1.200.000</strong> thành <strong>1.200.000/m²</strong></p>
                
                <h3>4. In và Lưu:</h3>
                <p>- Nhấn nút "In" để in hoặc lưu PDF</p>
                <p>- Nhấn "Xóa Tất Cả" để làm mới bảng</p>
            </div>
        </div>
    </div>

    <!-- Custom Confirm Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content confirm-modal">
            <h3 id="confirmMessage">Bạn có chắc chắn?</h3>
            <div class="confirm-buttons">
                <button onclick="confirmAction(true)" class="confirm-yes">Xác nhận</button>
                <button onclick="confirmAction(false)" class="confirm-no">Hủy</button>
            </div>²
        </div>
    </div>

    <!-- Modal chọn đơn vị -->
    <div id="unitModal" class="modal">
        <div class="modal-content">
            <h2>Chọn Đơn Vị</h2>
            <div class="unit-options">
                <div class="unit-option" onclick="selectUnit('/m²')">1. /m²</div>
                <div class="unit-option" onclick="selectUnit('/cái')">2. /cái</div>
                <div class="unit-option" onclick="selectUnit('/cây')">3. /cây</div>
            </div>
            <button onclick="closeUnitModal()" class="delete-btn" style="margin-top: 20px; width: 100%;">Đóng</button>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="bangbaogia.js"></script>
</body>
</html>
